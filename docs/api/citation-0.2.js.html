<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: citation-0.2.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: citation-0.2.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** 
 * @file Citation-0.2.js
 * 
 * @projectname Citationjs
 * 
 * @author Lars Willighagen
 * @version 0.2
 * @license
 * Copyright (c) 2015-2016 Lars Willighagen  
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:  
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.  
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/**
 * [CSL](https://citeproc-js.readthedocs.io/en/latest/csl-json/markup.html#csl-json-items) element
 * 
 * @class CSL
 */

var Cite = ( function ( modules, nodejsMode, browserMode ) {

var CSL = modules.CSL
  , striptags = modules.striptags
  , request = modules.request
  , window = modules.window
  , wdk = modules.wdk

if ( !nodejsMode &amp;&amp; !browserMode )
  throw new Error( 'Code executed in invalid environment' )

console.info( '[init]', nodejsMode ? 'Node.js' : browserMode ? 'Browser' : '', 'mode' )

/**
 * Object containing several RegExp patterns, mostly used for parsing (*full of shame*) and recognizing data types
 * 
 * @access private
 * @constant varRegex
 * @default
 */
var varRegex = {
  url:/^(https?:\/\/)?((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|((\d{1,3}\.){3}\d{1,3})|localhost)(\:\d+)?(\/[-a-z\d%_.~+:]*)*(\?[;&amp;a-z\d%_.~+=-]*)?(\#[-a-z\d_]*)?$/i
, bibtex: [
    /^(?:\s*@\s*[^@]+?\s*\{\s*[^@]+?\s*,\s*[^@]+\})+\s*$/
  , /^\s$/
  , /^[@{}"=,\\]$/
  ]
, wikidata: [
    /(?:\/|^)(Q\d+)$/
  , /(Q\d+)/
  , /^(?:Q\d+(?:\s+|,))*(?:Q\d+)(?:\s+|,)?$/
  ]
, json:[
    [ /((?:\[|:|,)\s*)'((?:\\'|[^'])*?[^\\])?'(?=\s*(?:\]|}|,))/g
    , '$1"$2"' ]
    
  , [ /((?:(?:"|]|}|\/[gmi]|\.|(?:\d|\.|-)*\d)\s*,|{)\s*)(?:"([^":\n]+?)"|'([^":\n]+?)'|([^":\n]+?))(\s*):/g
    , '$1"$2$3$4"$5:' ]
  ]
, name: / (?=(?:[a-z]+ )*(?:[A-Z][a-z]*[-])*(?:[A-Z][a-z]*)$)/
}

/**
 * Mapping of BibTeX syntax chars to BibTeX Escaped Chars.
 * 
 * From [Zotero's alwaysMap object](https://github.com/zotero/translators/blob/master/BibTeX.js#L225)
 * [REPO](https://github.com/zotero/translators)
 * 
 * Accesed 11/20/2016
 * 
 * @access private
 * @constant varBibTeXSyntaxTokens
 * @default
 */
var varBibTeXSyntaxTokens = {
  "|":"{\\textbar}",
  "&lt;":"{\\textless}",
  ">":"{\\textgreater}",
  "~":"{\\textasciitilde}",
  "^":"{\\textasciicircum}",
  "\\":"{\\textbackslash}",
  // See http://tex.stackexchange.com/questions/230750/open-brace-in-bibtex-fields/230754
  "{" : "\\{\\vphantom{\\}}",
  "}" : "\\vphantom{\\{}\\}"
}

/**
 * Mapping of BibTeX Escaped Chars to Unicode.
 * 
 * From [Zotero's reversed mapping table](https://github.com/zotero/translators/blob/master/BibTeX.js#L2353)
 * [REPO](https://github.com/zotero/translators)
 * 
 * Accesed 11/09/2016
 * 
 * @access private
 * @constant varBibTeXTokens
 * @default
 */
var varBibTeXTokens = {
  "\\url":"",                           "\\href":"",                            "{\\textexclamdown}":"\u00A1",          "{\\textcent}":"\u00A2",
  "{\\textsterling}":"\u00A3",          "{\\textyen}":"\u00A5",                 "{\\textbrokenbar}":"\u00A6",           "{\\textsection}":"\u00A7",
  "{\\textasciidieresis}":"\u00A8",     "{\\textcopyright}":"\u00A9",           "{\\textordfeminine}":"\u00AA",         "{\\guillemotleft}":"\u00AB",
  "{\\textlnot}":"\u00AC",              "{\\textregistered}":"\u00AE",          "{\\textasciimacron}":"\u00AF",         "{\\textdegree}":"\u00B0",
  "{\\textpm}":"\u00B1",                "{\\texttwosuperior}":"\u00B2",         "{\\textthreesuperior}":"\u00B3",       "{\\textasciiacute}":"\u00B4",
  "{\\textmu}":"\u00B5",                "{\\textparagraph}":"\u00B6",           "{\\textperiodcentered}":"\u00B7",      "{\\c\\ }":"\u00B8",
  "{\\textonesuperior}":"\u00B9",       "{\\textordmasculine}":"\u00BA",        "{\\guillemotright}":"\u00BB",          "{\\textonequarter}":"\u00BC",
  "{\\textonehalf}":"\u00BD",           "{\\textthreequarters}":"\u00BE",       "{\\textquestiondown}":"\u00BF",        "{\\AE}":"\u00C6",
  "{\\DH}":"\u00D0",                    "{\\texttimes}":"\u00D7",               "{\\O}":"\u00D8",                       "{\\TH}":"\u00DE",
  "{\\ss}":"\u00DF",                    "{\\ae}":"\u00E6",                      "{\\dh}":"\u00F0",                      "{\\textdiv}":"\u00F7",
  "{\\o}":"\u00F8",                     "{\\th}":"\u00FE",                      "{\\i}":"\u0131",                       "{\\NG}":"\u014A",
  "{\\ng}":"\u014B",                    "{\\OE}":"\u0152",                      "{\\oe}":"\u0153",                      "{\\textasciicircum}":"\u02C6",
  "{\\textacutedbl}":"\u02DD",          "$\\Gamma$":"\u0393",                   "$\\Delta$":"\u0394",                   "$\\Theta$":"\u0398",
  "$\\Lambda$":"\u039B",                "$\\Xi$":"\u039E",                      "$\\Pi$":"\u03A0",                      "$\\Sigma$":"\u03A3",
  "$\\Phi$":"\u03A6",                   "$\\Psi$":"\u03A8",                     "$\\Omega$":"\u03A9",                   "$\\alpha$":"\u03B1",
  "$\\beta$":"\u03B2",                  "$\\gamma$":"\u03B3",                   "$\\delta$":"\u03B4",                   "$\\varepsilon$":"\u03B5",
  "$\\zeta$":"\u03B6",                  "$\\eta$":"\u03B7",                     "$\\theta$":"\u03B8",                   "$\\iota$":"\u03B9",
  "$\\kappa$":"\u03BA",                 "$\\lambda$":"\u03BB",                  "$\\mu$":"\u03BC",                      "$\\nu$":"\u03BD",
  "$\\xi$":"\u03BE",                    "$\\pi$":"\u03C0",                      "$\\rho$":"\u03C1",                     "$\\varsigma$":"\u03C2",
  "$\\sigma$":"\u03C3",                 "$\\tau$":"\u03C4",                     "$\\upsilon$":"\u03C5",                 "$\\varphi$":"\u03C6",
  "$\\chi$":"\u03C7",                   "$\\psi$":"\u03C8",                     "$\\omega$":"\u03C9",                   "$\\vartheta$":"\u03D1",
  "$\\Upsilon$":"\u03D2",               "$\\phi$":"\u03D5",                     "$\\varpi$":"\u03D6",                   "$\\varrho$":"\u03F1",
  "$\\epsilon$":"\u03F5",               "{\\textendash}":"\u2013",              "{\\textemdash}":"\u2014",              "---":"\u2014",
  "--":"\u2013",                        "{\\textbardbl}":"\u2016",              "{\\textunderscore}":"\u2017",          "{\\textquoteleft}":"\u2018",
  "{\\textquoteright}":"\u2019",        "{\\quotesinglbase}":"\u201A",          "{\\textquotedblleft}":"\u201C",        "{\\textquotedblright}":"\u201D",
  "{\\quotedblbase}":"\u201E",          "{\\textdagger}":"\u2020",              "{\\textdaggerdbl}":"\u2021",           "{\\textbullet}":"\u2022",
  "{\\textellipsis}":"\u2026",          "{\\textperthousand}":"\u2030",         "'''":"\u2034",                         "''":"\u201D",
  "``":"\u201C",                        "```":"\u2037",                         "{\\guilsinglleft}":"\u2039",           "{\\guilsinglright}":"\u203A",
  "!!":"\u203C",                        "{\\textfractionsolidus}":"\u2044",     "?!":"\u2048",                          "!?":"\u2049",
  "$^{0}$":"\u2070",                    "$^{4}$":"\u2074",                      "$^{5}$":"\u2075",                      "$^{6}$":"\u2076",
  "$^{7}$":"\u2077",                    "$^{8}$":"\u2078",                      "$^{9}$":"\u2079",                      "$^{+}$":"\u207A",
  "$^{-}$":"\u207B",                    "$^{=}$":"\u207C",                      "$^{(}$":"\u207D",                      "$^{)}$":"\u207E",
  "$^{n}$":"\u207F",                    "$_{0}$":"\u2080",                      "$_{1}$":"\u2081",                      "$_{2}$":"\u2082",
  "$_{3}$":"\u2083",                    "$_{4}$":"\u2084",                      "$_{5}$":"\u2085",                      "$_{6}$":"\u2086",
  "$_{7}$":"\u2087",                    "$_{8}$":"\u2088",                      "$_{9}$":"\u2089",                      "$_{+}$":"\u208A",
  "$_{-}$":"\u208B",                    "$_{=}$":"\u208C",                      "$_{(}$":"\u208D",                      "$_{)}$":"\u208E",
  "{\\texteuro}":"\u20AC",              "{\\textcelsius}":"\u2103",             "{\\textnumero}":"\u2116",              "{\\textcircledP}":"\u2117",
  "{\\textservicemark}":"\u2120",       "{TEL}":"\u2121",                       "{\\texttrademark}":"\u2122",           "{\\textohm}":"\u2126",
  "{\\textestimated}":"\u212E",         "{\\`A}":"\u00C0",                      "{\\'A}":"\u00C1",                      "{\\^A}":"\u00C2",
  "{\\~A}":"\u00C3",                    "{\\\"A}":"\u00C4",                     "{\\r A}":"\u00C5",                     "{\\c C}":"\u00C7",
  "{\\`E}":"\u00C8",                    "{\\'E}":"\u00C9",                      "{\\^E}":"\u00CA",                      "{\\\"E}":"\u00CB",
  "{\\`I}":"\u00CC",                    "{\\'I}":"\u00CD",                      "{\\^I}":"\u00CE",                      "{\\\"I}":"\u00CF",
  "{\\~N}":"\u00D1",                    "{\\`O}":"\u00D2",                      "{\\'O}":"\u00D3",                      "{\\^O}":"\u00D4",
  "{\\~O}":"\u00D5",                    "{\\\"O}":"\u00D6",                     "{\\`U}":"\u00D9",                      "{\\'U}":"\u00DA",
  "{\\^U}":"\u00DB",                    "{\\\"U}":"\u00DC",                     "{\\'Y}":"\u00DD",                      "{\\`a}":"\u00E0",
  "{\\'a}":"\u00E1",                    "{\\^a}":"\u00E2",                      "{\\~a}":"\u00E3",                      "{\\\"a}":"\u00E4",
  "{\\r a}":"\u00E5",                   "{\\c c}":"\u00E7",                     "{\\`e}":"\u00E8",                      "{\\'e}":"\u00E9",
  "{\\^e}":"\u00EA",                    "{\\\"e}":"\u00EB",                     "{\\`i}":"\u00EC",                      "{\\'i}":"\u00ED",
  "{\\^i}":"\u00EE",                    "{\\\"i}":"\u00EF",                     "{\\~n}":"\u00F1",                      "{\\`o}":"\u00F2",
  "{\\'o}":"\u00F3",                    "{\\^o}":"\u00F4",                      "{\\~o}":"\u00F5",                      "{\\\"o}":"\u00F6",
  "{\\`u}":"\u00F9",                    "{\\'u}":"\u00FA",                      "{\\^u}":"\u00FB",                      "{\\\"u}":"\u00FC",
  "{\\'y}":"\u00FD",                    "{\\\"y}":"\u00FF",                     "{\\=A}":"\u0100",                      "{\\=a}":"\u0101",
  "{\\u A}":"\u0102",                   "{\\u a}":"\u0103",                     "{\\k A}":"\u0104",                     "{\\k a}":"\u0105",
  "{\\'C}":"\u0106",                    "{\\'c}":"\u0107",                      "{\\^C}":"\u0108",                      "{\\^c}":"\u0109",
  "{\\.C}":"\u010A",                    "{\\.c}":"\u010B",                      "{\\v C}":"\u010C",                     "{\\v c}":"\u010D",
  "{\\v D}":"\u010E",                   "{\\v d}":"\u010F",                     "{\\=E}":"\u0112",                      "{\\=e}":"\u0113",
  "{\\u E}":"\u0114",                   "{\\u e}":"\u0115",                     "{\\.E}":"\u0116",                      "{\\.e}":"\u0117",
  "{\\k E}":"\u0118",                   "{\\k e}":"\u0119",                     "{\\v E}":"\u011A",                     "{\\v e}":"\u011B",
  "{\\^G}":"\u011C",                    "{\\^g}":"\u011D",                      "{\\u G}":"\u011E",                     "{\\u g}":"\u011F",
  "{\\.G}":"\u0120",                    "{\\.g}":"\u0121",                      "{\\c G}":"\u0122",                     "{\\c g}":"\u0123",
  "{\\^H}":"\u0124",                    "{\\^h}":"\u0125",                      "{\\~I}":"\u0128",                      "{\\~i}":"\u0129",
  "{\\=I}":"\u012A",                    "{\\=i}":"\u012B",                      "{\\=\\i}":"\u012B",                    "{\\u I}":"\u012C",
  "{\\u i}":"\u012D",                   "{\\k I}":"\u012E",                     "{\\k i}":"\u012F",                     "{\\.I}":"\u0130",
  "{\\^J}":"\u0134",                    "{\\^j}":"\u0135",                      "{\\c K}":"\u0136",                     "{\\c k}":"\u0137",
  "{\\'L}":"\u0139",                    "{\\'l}":"\u013A",                      "{\\c L}":"\u013B",                     "{\\c l}":"\u013C",
  "{\\v L}":"\u013D",                   "{\\v l}":"\u013E",                     "{\\L }":"\u0141",                      "{\\l }":"\u0142",
  "{\\'N}":"\u0143",                    "{\\'n}":"\u0144",                      "{\\c N}":"\u0145",                     "{\\c n}":"\u0146",
  "{\\v N}":"\u0147",                   "{\\v n}":"\u0148",                     "{\\=O}":"\u014C",                      "{\\=o}":"\u014D",
  "{\\u O}":"\u014E",                   "{\\u o}":"\u014F",                     "{\\H O}":"\u0150",                     "{\\H o}":"\u0151",
  "{\\'R}":"\u0154",                    "{\\'r}":"\u0155",                      "{\\c R}":"\u0156",                     "{\\c r}":"\u0157",
  "{\\v R}":"\u0158",                   "{\\v r}":"\u0159",                     "{\\'S}":"\u015A",                      "{\\'s}":"\u015B",
  "{\\^S}":"\u015C",                    "{\\^s}":"\u015D",                      "{\\c S}":"\u015E",                     "{\\c s}":"\u015F",
  "{\\v S}":"\u0160",                   "{\\v s}":"\u0161",                     "{\\c T}":"\u0162",                     "{\\c t}":"\u0163",
  "{\\v T}":"\u0164",                   "{\\v t}":"\u0165",                     "{\\~U}":"\u0168",                      "{\\~u}":"\u0169",
  "{\\=U}":"\u016A",                    "{\\=u}":"\u016B",                      "{\\u U}":"\u016C",                     "{\\u u}":"\u016D",
  "{\\r U}":"\u016E",                   "{\\r u}":"\u016F",                     "{\\H U}":"\u0170",                     "{\\H u}":"\u0171",
  "{\\k U}":"\u0172",                   "{\\k u}":"\u0173",                     "{\\^W}":"\u0174",                      "{\\^w}":"\u0175",
  "{\\^Y}":"\u0176",                    "{\\^y}":"\u0177",                      "{\\\"Y}":"\u0178",                     "{\\'Z}":"\u0179",
  "{\\'z}":"\u017A",                    "{\\.Z}":"\u017B",                      "{\\.z}":"\u017C",                      "{\\v Z}":"\u017D",
  "{\\v z}":"\u017E",                   "{\\v A}":"\u01CD",                     "{\\v a}":"\u01CE",                     "{\\v I}":"\u01CF",
  "{\\v i}":"\u01D0",                   "{\\v O}":"\u01D1",                     "{\\v o}":"\u01D2",                     "{\\v U}":"\u01D3",
  "{\\v u}":"\u01D4",                   "{\\v G}":"\u01E6",                     "{\\v g}":"\u01E7",                     "{\\v K}":"\u01E8",
  "{\\v k}":"\u01E9",                   "{\\k O}":"\u01EA",                     "{\\k o}":"\u01EB",                     "{\\v j}":"\u01F0",
  "{\\'G}":"\u01F4",                    "{\\'g}":"\u01F5",                      "{\\.B}":"\u1E02",                      "{\\.b}":"\u1E03",
  "{\\d B}":"\u1E04",                   "{\\d b}":"\u1E05",                     "{\\b B}":"\u1E06",                     "{\\b b}":"\u1E07",
  "{\\.D}":"\u1E0A",                    "{\\.d}":"\u1E0B",                      "{\\d D}":"\u1E0C",                     "{\\d d}":"\u1E0D",
  "{\\b D}":"\u1E0E",                   "{\\b d}":"\u1E0F",                     "{\\c D}":"\u1E10",                     "{\\c d}":"\u1E11",
  "{\\.F}":"\u1E1E",                    "{\\.f}":"\u1E1F",                      "{\\=G}":"\u1E20",                      "{\\=g}":"\u1E21",
  "{\\.H}":"\u1E22",                    "{\\.h}":"\u1E23",                      "{\\d H}":"\u1E24",                     "{\\d h}":"\u1E25",
  "{\\\"H}":"\u1E26",                   "{\\\"h}":"\u1E27",                     "{\\c H}":"\u1E28",                     "{\\c h}":"\u1E29",
  "{\\'K}":"\u1E30",                    "{\\'k}":"\u1E31",                      "{\\d K}":"\u1E32",                     "{\\d k}":"\u1E33",
  "{\\b K}":"\u1E34",                   "{\\b k}":"\u1E35",                     "{\\d L}":"\u1E36",                     "{\\d l}":"\u1E37",
  "{\\b L}":"\u1E3A",                   "{\\b l}":"\u1E3B",                     "{\\'M}":"\u1E3E",                      "{\\'m}":"\u1E3F",
  "{\\.M}":"\u1E40",                    "{\\.m}":"\u1E41",                      "{\\d M}":"\u1E42",                     "{\\d m}":"\u1E43",
  "{\\.N}":"\u1E44",                    "{\\.n}":"\u1E45",                      "{\\d N}":"\u1E46",                     "{\\d n}":"\u1E47",
  "{\\b N}":"\u1E48",                   "{\\b n}":"\u1E49",                     "{\\'P}":"\u1E54",                      "{\\'p}":"\u1E55",
  "{\\.P}":"\u1E56",                    "{\\.p}":"\u1E57",                      "{\\.R}":"\u1E58",                      "{\\.r}":"\u1E59",
  "{\\d R}":"\u1E5A",                   "{\\d r}":"\u1E5B",                     "{\\b R}":"\u1E5E",                     "{\\b r}":"\u1E5F",
  "{\\.S}":"\u1E60",                    "{\\.s}":"\u1E61",                      "{\\d S}":"\u1E62",                     "{\\d s}":"\u1E63",
  "{\\.T}":"\u1E6A",                    "{\\.t}":"\u1E6B",                      "{\\d T}":"\u1E6C",                     "{\\d t}":"\u1E6D",
  "{\\b T}":"\u1E6E",                   "{\\b t}":"\u1E6F",                     "{\\~V}":"\u1E7C",                      "{\\~v}":"\u1E7D",
  "{\\d V}":"\u1E7E",                   "{\\d v}":"\u1E7F",                     "{\\`W}":"\u1E80",                      "{\\`w}":"\u1E81",
  "{\\'W}":"\u1E82",                    "{\\'w}":"\u1E83",                      "{\\\"W}":"\u1E84",                     "{\\\"w}":"\u1E85",
  "{\\.W}":"\u1E86",                    "{\\.w}":"\u1E87",                      "{\\d W}":"\u1E88",                     "{\\d w}":"\u1E89",
  "{\\.X}":"\u1E8A",                    "{\\.x}":"\u1E8B",                      "{\\\"X}":"\u1E8C",                     "{\\\"x}":"\u1E8D",
  "{\\.Y}":"\u1E8E",                    "{\\.y}":"\u1E8F",                      "{\\^Z}":"\u1E90",                      "{\\^z}":"\u1E91",
  "{\\d Z}":"\u1E92",                   "{\\d z}":"\u1E93",                     "{\\b Z}":"\u1E94",                     "{\\b z}":"\u1E95",
  "{\\b h}":"\u1E96",                   "{\\\"t}":"\u1E97",                     "{\\r w}":"\u1E98",                     "{\\r y}":"\u1e99",
  "{\\d A}":"\u1EA0",                   "{\\d a}":"\u1EA1",                     "{\\d E}":"\u1EB8",                     "{\\d e}":"\u1EB9",
  "{\\~E}":"\u1EBC",                    "{\\~e}":"\u1EBD",                      "{\\d I}":"\u1ECA",                     "{\\d i}":"\u1ECB",
  "{\\d O}":"\u1ECC",                   "{\\d o}":"\u1ECD",                     "{\\d U}":"\u1EE4",                     "{\\d u}":"\u1EE5",
  "{\\`Y}":"\u1EF2",                    "{\\`y}":"\u1EF3",                      "{\\d Y}":"\u1EF4",                     "{\\d y}":"\u1EF5",
  "{\\~Y}":"\u1EF8",                    "{\\~y}":"\u1EF9",                      "{\\~}":"\u223C",                       "~":"\u00A0" 
}

/**
 * Object containing a list of Wikidata Instances and it's corresponding name as specified by the docs
 * 
 * @access private
 * @constant varWikidataTypes
 * @default
 */
var varWikidataTypes = {
  Q13442814: 'article-journal'
, Q18918145: 'article-journal'
, Q191067  : 'article'
, Q3331189 : 'book'
, Q571     : 'book'
}

/**
 * Object containing CSL templates
 * 
 * Templates from the [CSL Project](http://citationstyles.org/)  
 * [REPO](https://github.com/citation-style-language/styles), [LICENSE](https://creativecommons.org/licenses/by-sa/3.0/)
 * 
 * Accesed 10/22/2016
 * 
 * @access private
 * @constant varCSLStyles
 * @default
 */
var varCSLStyles = {
  apa: '&lt;?xml version="1.0" encoding="utf-8"?>&lt;style xmlns="http://purl.org/net/xbiblio/csl" class="in-text" version="1.0" demote-non-dropping-particle="never">&lt;info>&lt;title>American Psychological Association 6th edition&lt;/title>&lt;title-short>APA&lt;/title-short>&lt;id>http://www.zotero.org/styles/apa&lt;/id>&lt;link href="http://www.zotero.org/styles/apa" rel="self"/>&lt;link href="http://owl.english.purdue.edu/owl/resource/560/01/" rel="documentation"/>&lt;author>&lt;name>Simon Kornblith&lt;/name>&lt;email>simon@simonster.com&lt;/email>&lt;/author>&lt;contributor>&lt;name>Bruce D\'Arcus&lt;/name>&lt;/contributor>&lt;contributor>&lt;name>Curtis M. Humphrey&lt;/name>&lt;/contributor>&lt;contributor>&lt;name>Richard Karnesky&lt;/name>&lt;email>karnesky+zotero@gmail.com&lt;/email>&lt;uri>http://arc.nucapt.northwestern.edu/Richard_Karnesky&lt;/uri>&lt;/contributor>&lt;contributor>&lt;name>Sebastian Karcher&lt;/name>&lt;/contributor>&lt;contributor>&lt;name> Brenton M. Wiernik&lt;/name>&lt;email>zotero@wiernik.org&lt;/email>&lt;/contributor>&lt;category citation-format="author-date"/>&lt;category field="psychology"/>&lt;category field="generic-base"/>&lt;updated>2016-05-25T09:01:49+00:00&lt;/updated>&lt;rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License&lt;/rights>&lt;/info>&lt;locale xml:lang="en">&lt;terms>&lt;term name="editortranslator" form="short">&lt;single>ed. &amp;amp; trans.&lt;/single>&lt;multiple>eds. &amp;amp; trans.&lt;/multiple>&lt;/term>&lt;term name="translator" form="short">&lt;single>trans.&lt;/single>&lt;multiple>trans.&lt;/multiple>&lt;/term>&lt;/terms>&lt;/locale>&lt;macro name="container-contributors">&lt;choose>&lt;if type="chapter paper-conference entry-dictionary entry-encyclopedia" match="any">&lt;group delimiter=", ">&lt;names variable="container-author" delimiter=", ">&lt;name and="symbol" initialize-with=". " delimiter=", "/>&lt;label form="short" prefix=" (" text-case="title" suffix=")"/>&lt;/names>&lt;names variable="editor translator" delimiter=", ">&lt;name and="symbol" initialize-with=". " delimiter=", "/>&lt;label form="short" prefix=" (" text-case="title" suffix=")"/>&lt;/names>&lt;/group>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="secondary-contributors">&lt;choose>&lt;if type="article-journal chapter paper-conference entry-dictionary entry-encyclopedia" match="none">&lt;group delimiter=", " prefix=" (" suffix=")">&lt;names variable="container-author" delimiter=", ">&lt;name and="symbol" initialize-with=". " delimiter=", "/>&lt;label form="short" prefix=", " text-case="title"/>&lt;/names>&lt;names variable="editor translator" delimiter=", ">&lt;name and="symbol" initialize-with=". " delimiter=", "/>&lt;label form="short" prefix=", " text-case="title"/>&lt;/names>&lt;/group>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="author">&lt;names variable="author">&lt;name name-as-sort-order="all" and="symbol" sort-separator=", " initialize-with=". " delimiter=", " delimiter-precedes-last="always"/>&lt;label form="short" prefix=" (" suffix=")" text-case="capitalize-first"/>&lt;substitute>&lt;names variable="editor"/>&lt;names variable="translator"/>&lt;choose>&lt;if type="report">&lt;text variable="publisher"/>&lt;text macro="title"/>&lt;/if>&lt;else>&lt;text macro="title"/>&lt;/else>&lt;/choose>&lt;/substitute>&lt;/names>&lt;/macro>&lt;macro name="author-short">&lt;names variable="author">&lt;name form="short" and="symbol" delimiter=", " initialize-with=". "/>&lt;substitute>&lt;names variable="editor"/>&lt;names variable="translator"/>&lt;choose>&lt;if type="report">&lt;text variable="publisher"/>&lt;text variable="title" form="short" font-style="italic"/>&lt;/if>&lt;else-if type="legal_case">&lt;text variable="title" font-style="italic"/>&lt;/else-if>&lt;else-if type="bill book graphic legislation motion_picture song" match="any">&lt;text variable="title" form="short" font-style="italic"/>&lt;/else-if>&lt;else-if variable="reviewed-author">&lt;choose>&lt;if variable="reviewed-title" match="none">&lt;text variable="title" form="short" font-style="italic" prefix="Review of "/>&lt;/if>&lt;else>&lt;text variable="title" form="short" quotes="true"/>&lt;/else>&lt;/choose>&lt;/else-if>&lt;else>&lt;text variable="title" form="short" quotes="true"/>&lt;/else>&lt;/choose>&lt;/substitute>&lt;/names>&lt;/macro>&lt;macro name="access">&lt;choose>&lt;if type="thesis report" match="any">&lt;choose>&lt;if variable="DOI" match="any">'+
'&lt;text variable="DOI" prefix="https://doi.org/"/>&lt;/if>&lt;else-if variable="archive" match="any">&lt;group>&lt;text term="retrieved" text-case="capitalize-first" suffix=" "/>&lt;text term="from" suffix=" "/>&lt;text variable="archive" suffix="."/>&lt;text variable="archive_location" prefix=" (" suffix=")"/>&lt;/group>&lt;/else-if>&lt;else>&lt;group>&lt;text term="retrieved" text-case="capitalize-first" suffix=" "/>&lt;text term="from" suffix=" "/>&lt;text variable="URL"/>&lt;/group>&lt;/else>&lt;/choose>&lt;/if>&lt;else>&lt;choose>&lt;if variable="DOI">&lt;text variable="DOI" prefix="https://doi.org/"/>&lt;/if>&lt;else>&lt;choose>&lt;if type="webpage">&lt;group delimiter=" ">&lt;text term="retrieved" text-case="capitalize-first" suffix=" "/>&lt;group>&lt;date variable="accessed" form="text" suffix=", "/>&lt;/group>&lt;text term="from"/>&lt;text variable="URL"/>&lt;/group>&lt;/if>&lt;else>&lt;group>&lt;text term="retrieved" text-case="capitalize-first" suffix=" "/>&lt;text term="from" suffix=" "/>&lt;text variable="URL"/>&lt;/group>&lt;/else>&lt;/choose>&lt;/else>&lt;/choose>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="title">&lt;choose>&lt;if type="book graphic manuscript motion_picture report song speech thesis" match="any">&lt;choose>&lt;if variable="version" type="book" match="all">&lt;text variable="title"/>&lt;/if>&lt;else>&lt;text variable="title" font-style="italic"/>&lt;/else>&lt;/choose>&lt;/if>&lt;else-if variable="reviewed-author">&lt;choose>&lt;if variable="reviewed-title">&lt;group delimiter=" ">&lt;text variable="title"/>&lt;group delimiter=", " prefix="[" suffix="]">&lt;text variable="reviewed-title" font-style="italic" prefix="Review of "/>&lt;names variable="reviewed-author" delimiter=", ">&lt;label form="verb-short" suffix=" "/>&lt;name and="symbol" initialize-with=". " delimiter=", "/>&lt;/names>&lt;/group>&lt;/group>&lt;/if>&lt;else>&lt;group delimiter=", " prefix="[" suffix="]">&lt;text variable="title" font-style="italic" prefix="Review of "/>&lt;names variable="reviewed-author" delimiter=", ">&lt;label form="verb-short" suffix=" "/>&lt;name and="symbol" initialize-with=". " delimiter=", "/>&lt;/names>&lt;/group>&lt;/else>&lt;/choose>&lt;/else-if>&lt;else>&lt;text variable="title"/>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="title-plus-extra">&lt;text macro="title"/>&lt;choose>&lt;if type="report thesis" match="any">&lt;group prefix=" (" suffix=")" delimiter=", ">&lt;group delimiter=" ">&lt;choose>&lt;if variable="genre" match="any">&lt;text variable="genre"/>&lt;/if>&lt;else>&lt;text variable="collection-title"/>&lt;/else>&lt;/choose>&lt;text variable="number" prefix="No. "/>&lt;/group>&lt;group delimiter=" ">&lt;text term="version" text-case="capitalize-first"/>&lt;text variable="version"/>&lt;/group>&lt;text macro="edition"/>&lt;/group>&lt;/if>&lt;else-if type="post-weblog webpage" match="any">&lt;text variable="genre" prefix=" [" suffix="]"/>&lt;/else-if>&lt;else-if variable="version">&lt;group delimiter=" " prefix=" (" suffix=")">&lt;text term="version" text-case="capitalize-first"/>&lt;text variable="version"/>&lt;/group>&lt;/else-if>&lt;/choose>&lt;text macro="format" prefix=" [" suffix="]"/>&lt;/macro>&lt;macro name="format">&lt;choose>&lt;if match="any" variable="medium">&lt;text variable="medium" text-case="capitalize-first"/>&lt;/if>&lt;else-if type="dataset" match="any">&lt;text value="Data set"/>&lt;/else-if>&lt;/choose>&lt;/macro>&lt;macro name="publisher">&lt;choose>&lt;if type="report" match="any">&lt;group delimiter=": ">&lt;text variable="publisher-place"/>&lt;text variable="publisher"/>&lt;/group>&lt;/if>&lt;else-if type="thesis" match="any">&lt;group delimiter=", ">&lt;text variable="publisher"/>&lt;text variable="publisher-place"/>&lt;/group>&lt;/else-if>&lt;else-if type="post-weblog webpage" match="none">&lt;group delimiter=", ">&lt;choose>&lt;if variable="event version" type="speech motion_picture" match="none">&lt;text variable="genre"/>&lt;/if>&lt;/choose>&lt;choose>&lt;if type="article-journal article-magazine" match="none">&lt;group delimiter=": ">&lt;choose>&lt;if variable="publisher-place">&lt;text variable="publisher-place"/>&lt;/if>&lt;else>&lt;text variable="event-place"/>&lt;/else>&lt;/choose>&lt;text variable="publisher"/>&lt;/group>&lt;/if>&lt;/choose>&lt;/group>&lt;/else-if>&lt;/choose>&lt;/macro>&lt;macro name="event">&lt;choose>&lt;if variable="container-title" match="none">&lt;choose>&lt;if variable="event">&lt;choose>&lt;if variable="genre" match="none">&lt;text term="presented at" text-case="capitalize-first" suffix=" "/>&lt;text variable="event"/>&lt;/if>&lt;else>'+
'&lt;group delimiter=" ">&lt;text variable="genre" text-case="capitalize-first"/>&lt;text term="presented at"/>&lt;text variable="event"/>&lt;/group>&lt;/else>&lt;/choose>&lt;/if>&lt;else-if type="speech">&lt;text variable="genre" text-case="capitalize-first"/>&lt;/else-if>&lt;/choose>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="issued">&lt;choose>&lt;if type="bill legal_case legislation" match="none">&lt;choose>&lt;if variable="issued">&lt;group prefix=" (" suffix=")">&lt;date variable="issued">&lt;date-part name="year"/>&lt;/date>&lt;text variable="year-suffix"/>&lt;choose>&lt;if type="speech" match="any">&lt;date variable="issued">&lt;date-part prefix=", " name="month"/>&lt;/date>&lt;/if>&lt;else-if type="article-journal bill book chapter graphic legal_case legislation motion_picture paper-conference report song dataset" match="none">&lt;date variable="issued">&lt;date-part prefix=", " name="month"/>&lt;date-part prefix=" " name="day"/>&lt;/date>&lt;/else-if>&lt;/choose>&lt;/group>&lt;/if>&lt;else-if variable="status">&lt;group prefix=" (" suffix=")">&lt;text variable="status"/>&lt;text variable="year-suffix" prefix="-"/>&lt;/group>&lt;/else-if>&lt;else>&lt;group prefix=" (" suffix=")">&lt;text term="no date" form="short"/>&lt;text variable="year-suffix" prefix="-"/>&lt;/group>&lt;/else>&lt;/choose>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="issued-sort">&lt;choose>&lt;if type="article-journal bill book chapter graphic legal_case legislation motion_picture paper-conference report song dataset" match="none">&lt;date variable="issued">&lt;date-part name="year"/>&lt;date-part name="month"/>&lt;date-part name="day"/>&lt;/date>&lt;/if>&lt;else>&lt;date variable="issued">&lt;date-part name="year"/>&lt;/date>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="issued-year">&lt;choose>&lt;if variable="issued">&lt;group delimiter="/">&lt;date variable="original-date" form="text"/>&lt;group>&lt;date variable="issued">&lt;date-part name="year"/>&lt;/date>&lt;text variable="year-suffix"/>&lt;/group>&lt;/group>&lt;/if>&lt;else-if variable="status">&lt;text variable="status"/>&lt;text variable="year-suffix" prefix="-"/>&lt;/else-if>&lt;else>&lt;text term="no date" form="short"/>&lt;text variable="year-suffix" prefix="-"/>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="edition">&lt;choose>&lt;if is-numeric="edition">&lt;group delimiter=" ">&lt;number variable="edition" form="ordinal"/>&lt;text term="edition" form="short"/>&lt;/group>&lt;/if>&lt;else>&lt;text variable="edition"/>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="locators">&lt;choose>&lt;if type="article-journal article-magazine" match="any">&lt;group prefix=", " delimiter=", ">&lt;group>&lt;text variable="volume" font-style="italic"/>&lt;text variable="issue" prefix="(" suffix=")"/>&lt;/group>&lt;text variable="page"/>&lt;/group>&lt;choose>&lt;if variable="issued">&lt;choose>&lt;if variable="page issue" match="none">&lt;text variable="status" prefix=". "/>&lt;/if>&lt;/choose>&lt;/if>&lt;/choose>&lt;/if>&lt;else-if type="article-newspaper">&lt;group delimiter=" " prefix=", ">&lt;label variable="page" form="short"/>&lt;text variable="page"/>&lt;/group>&lt;/else-if>&lt;else-if type="book graphic motion_picture report song chapter paper-conference entry-encyclopedia entry-dictionary" match="any">&lt;group prefix=" (" suffix=")" delimiter=", ">&lt;choose>&lt;if type="report" match="none">&lt;text macro="edition"/>&lt;/if>&lt;/choose>&lt;choose>&lt;if variable="volume" match="any">&lt;group>&lt;text term="volume" form="short" text-case="capitalize-first" suffix=" "/>&lt;number variable="volume" form="numeric"/>&lt;/group>&lt;/if>&lt;else>&lt;group>&lt;text term="volume" form="short" plural="true" text-case="capitalize-first" suffix=" "/>&lt;number variable="number-of-volumes" form="numeric" prefix="1&amp;#8211;"/>&lt;/group>&lt;/else>&lt;/choose>&lt;group>&lt;label variable="page" form="short" suffix=" "/>&lt;text variable="page"/>&lt;/group>&lt;/group>&lt;/else-if>&lt;else-if type="legal_case">&lt;group prefix=" (" suffix=")" delimiter=" ">&lt;text variable="authority"/>&lt;date variable="issued" form="text"/>&lt;/group>&lt;/else-if>&lt;else-if type="bill legislation" match="any">&lt;date variable="issued" prefix=" (" suffix=")">&lt;date-part name="year"/>&lt;/date>&lt;/else-if>&lt;/choose>&lt;/macro>&lt;macro name="citation-locator">&lt;group>&lt;choose>&lt;if locator="chapter">&lt;label variable="locator" form="long" text-case="capitalize-first"/>&lt;/if>&lt;else>&lt;label variable="locator" form="short"/>&lt;/else>&lt;/choose>&lt;text variable="locator" prefix=" "/>&lt;/group>&lt;/macro>'+
'&lt;macro name="container">&lt;choose>&lt;if type="post-weblog webpage" match="none">&lt;group>&lt;choose>&lt;if type="chapter paper-conference entry-encyclopedia" match="any">&lt;text term="in" text-case="capitalize-first" suffix=" "/>&lt;/if>&lt;/choose>&lt;group delimiter=", ">&lt;text macro="container-contributors"/>&lt;text macro="secondary-contributors"/>&lt;text macro="container-title"/>&lt;/group>&lt;/group>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="container-title">&lt;choose>&lt;if type="article article-journal article-magazine article-newspaper" match="any">&lt;text variable="container-title" font-style="italic" text-case="title"/>&lt;/if>&lt;else-if type="bill legal_case legislation" match="none">&lt;text variable="container-title" font-style="italic"/>&lt;/else-if>&lt;/choose>&lt;/macro>&lt;macro name="legal-cites">&lt;choose>&lt;if type="bill legal_case legislation" match="any">&lt;group delimiter=" " prefix=", ">&lt;choose>&lt;if variable="container-title">&lt;text variable="volume"/>&lt;text variable="container-title"/>&lt;group delimiter=" ">&lt;text term="section" form="symbol"/>&lt;text variable="section"/>&lt;/group>&lt;text variable="page"/>&lt;/if>&lt;else>&lt;choose>&lt;if type="legal_case">&lt;text variable="number" prefix="No. "/>&lt;/if>&lt;else>&lt;text variable="number" prefix="Pub. L. No. "/>&lt;group delimiter=" ">&lt;text term="section" form="symbol"/>&lt;text variable="section"/>&lt;/group>&lt;/else>&lt;/choose>&lt;/else>&lt;/choose>&lt;/group>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="original-date">&lt;choose>&lt;if variable="original-date">&lt;group prefix="(" suffix=")" delimiter=" ">&lt;text value="Original work published"/>&lt;date variable="original-date" form="text"/>&lt;/group>&lt;/if>&lt;/choose>&lt;/macro>&lt;citation et-al-min="6" et-al-use-first="1" et-al-subsequent-min="3" et-al-subsequent-use-first="1" disambiguate-add-year-suffix="true" disambiguate-add-names="true" disambiguate-add-givenname="true" collapse="year" givenname-disambiguation-rule="primary-name">&lt;sort>&lt;key macro="author"/>&lt;key macro="issued-sort"/>&lt;/sort>&lt;layout prefix="(" suffix=")" delimiter="; ">&lt;group delimiter=", ">&lt;text macro="author-short"/>&lt;text macro="issued-year"/>&lt;text macro="citation-locator"/>&lt;/group>&lt;/layout>&lt;/citation>&lt;bibliography hanging-indent="true" et-al-min="8" et-al-use-first="6" et-al-use-last="true" entry-spacing="0" line-spacing="2">&lt;sort>&lt;key macro="author"/>&lt;key macro="issued-sort" sort="ascending"/>&lt;key macro="title"/>&lt;/sort>&lt;layout>&lt;group suffix=".">&lt;group delimiter=". ">&lt;text macro="author"/>&lt;text macro="issued"/>&lt;text macro="title-plus-extra"/>&lt;text macro="container"/>&lt;/group>&lt;text macro="legal-cites"/>&lt;text macro="locators"/>&lt;group delimiter=", " prefix=". ">&lt;text macro="event"/>&lt;text macro="publisher"/>&lt;/group>&lt;/group>&lt;text macro="access" prefix=" "/>&lt;text macro="original-date" prefix=" "/>&lt;/layout>&lt;/bibliography>&lt;/style>'
, vancouver: '&lt;?xml version="1.0" encoding="utf-8"?>&lt;style xmlns="http://purl.org/net/xbiblio/csl" class="in-text" version="1.0" demote-non-dropping-particle="sort-only" page-range-format="minimal">&lt;info>&lt;title>Vancouver&lt;/title>&lt;id>http://www.zotero.org/styles/vancouver&lt;/id>&lt;link href="http://www.zotero.org/styles/vancouver" rel="self"/>&lt;link href="http://www.nlm.nih.gov/bsd/uniform_requirements.html" rel="documentation"/>&lt;author>&lt;name>Michael Berkowitz&lt;/name>&lt;email>mberkowi@gmu.edu&lt;/email>&lt;/author>&lt;contributor>&lt;name>Sean Takats&lt;/name>&lt;email>stakats@gmu.edu&lt;/email>&lt;/contributor>&lt;contributor>&lt;name>Sebastian Karcher&lt;/name>&lt;/contributor>&lt;category citation-format="numeric"/>&lt;category field="medicine"/>&lt;summary>Vancouver style as outlined by International Committee of Medical Journal Editors Uniform Requirements for Manuscripts Submitted to Biomedical Journals: Sample References&lt;/summary>&lt;updated>2014-09-06T16:03:01+00:00&lt;/updated>&lt;rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License&lt;/rights>&lt;/info>&lt;locale xml:lang="en">&lt;date form="text" delimiter=" ">&lt;date-part name="year"/>&lt;date-part name="month" form="short" strip-periods="true"/>&lt;date-part name="day"/>&lt;/date>&lt;terms>&lt;term name="collection-editor" form="long">&lt;single>editor&lt;/single>&lt;multiple>editors&lt;/multiple>&lt;/term>&lt;term name="presented at">presented at&lt;/term>&lt;term name="available at">available from&lt;/term>&lt;term name="section" form="short">sect.&lt;/term>&lt;/terms>&lt;/locale>&lt;locale xml:lang="fr">&lt;date form="text" delimiter=" ">&lt;date-part name="day"/>&lt;date-part name="month" form="short" strip-periods="true"/>&lt;date-part name="year"/>&lt;/date>&lt;/locale>&lt;macro name="author">&lt;names variable="author">&lt;name sort-separator=" " initialize-with="" name-as-sort-order="all" delimiter=", " delimiter-precedes-last="always"/>&lt;label form="long" prefix=", "/>&lt;substitute>&lt;names variable="editor"/>&lt;/substitute>&lt;/names>&lt;/macro>&lt;macro name="editor">&lt;names variable="editor" suffix=".">&lt;name sort-separator=" " initialize-with="" name-as-sort-order="all" delimiter=", " delimiter-precedes-last="always"/>&lt;label form="long" prefix=", "/>&lt;/names>&lt;/macro>&lt;macro name="chapter-marker">&lt;choose>&lt;if type="chapter paper-conference entry-dictionary entry-encyclopedia" match="any">&lt;text term="in" text-case="capitalize-first"/>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="publisher">&lt;choose>&lt;if type="article-journal article-magazine article-newspaper" match="none">&lt;group delimiter=": " suffix=";">&lt;choose>&lt;if type="thesis">&lt;text variable="publisher-place" prefix="[" suffix="]"/>&lt;/if>&lt;else-if type="speech"/>&lt;else>&lt;text variable="publisher-place"/>&lt;/else>&lt;/choose>&lt;text variable="publisher"/>&lt;/group>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="access">&lt;choose>&lt;if variable="URL">&lt;group delimiter=": ">&lt;text term="available at" text-case="capitalize-first"/>&lt;text variable="URL"/>&lt;/group>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="accessed-date">&lt;choose>&lt;if variable="URL">&lt;group prefix="[" suffix="]" delimiter=" ">&lt;text term="cited" text-case="lowercase"/>&lt;date variable="accessed" form="text"/>&lt;/group>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="container-title">&lt;choose>&lt;if type="article-journal article-magazine chapter paper-conference article-newspaper review review-book entry-dictionary entry-encyclopedia" match="any">&lt;group suffix="." delimiter=" ">&lt;choose>&lt;if type="article-journal review review-book" match="any">&lt;text variable="container-title" form="short" strip-periods="true"/>&lt;/if>&lt;else>&lt;text variable="container-title" strip-periods="true"/>&lt;/else>&lt;/choose>&lt;choose>&lt;if variable="URL">&lt;text term="internet" prefix="[" suffix="]" text-case="capitalize-first"/>&lt;/if>&lt;/choose>&lt;/group>&lt;text macro="edition" prefix=" "/>&lt;/if>&lt;else-if type="bill legislation" match="any">&lt;group delimiter=", ">&lt;group delimiter=". ">&lt;text variable="container-title"/>&lt;group delimiter=" ">&lt;text term="section" form="short" text-case="capitalize-first"/>&lt;text variable="section"/>&lt;/group>&lt;/group>&lt;text variable="number"/>&lt;/group>&lt;/else-if>&lt;else-if type="speech">'+
'&lt;group delimiter=": " suffix=";">&lt;group delimiter=" ">&lt;text variable="genre" text-case="capitalize-first"/>&lt;text term="presented at"/>&lt;/group>&lt;text variable="event"/>&lt;/group>&lt;/else-if>&lt;else>&lt;group delimiter=", " suffix=".">&lt;choose>&lt;if variable="collection-title" match="none">&lt;group delimiter=" ">&lt;label variable="volume" form="short" text-case="capitalize-first"/>&lt;text variable="volume"/>&lt;/group>&lt;/if>&lt;/choose>&lt;text variable="container-title"/>&lt;/group>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="title">&lt;text variable="title"/>&lt;choose>&lt;if type="article-journal article-magazine chapter paper-conference article-newspaper review review-book entry-dictionary entry-encyclopedia" match="none">&lt;choose>&lt;if variable="URL">&lt;text term="internet" prefix=" [" suffix="]" text-case="capitalize-first"/>&lt;/if>&lt;/choose>&lt;text macro="edition" prefix=". "/>&lt;/if>&lt;/choose>&lt;choose>&lt;if type="thesis">&lt;text variable="genre" prefix=" [" suffix="]"/>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="edition">&lt;choose>&lt;if is-numeric="edition">&lt;group delimiter=" ">&lt;number variable="edition" form="ordinal"/>&lt;text term="edition" form="short"/>&lt;/group>&lt;/if>&lt;else>&lt;text variable="edition" suffix="."/>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="date">&lt;choose>&lt;if type="article-journal article-magazine article-newspaper review review-book" match="any">&lt;group suffix=";" delimiter=" ">&lt;date variable="issued" form="text"/>&lt;text macro="accessed-date"/>&lt;/group>&lt;/if>&lt;else-if type="bill legislation" match="any">&lt;group delimiter=", ">&lt;date variable="issued" delimiter=" ">&lt;date-part name="month" form="short" strip-periods="true"/>&lt;date-part name="day"/>&lt;/date>&lt;date variable="issued">&lt;date-part name="year"/>&lt;/date>&lt;/group>&lt;/else-if>&lt;else-if type="report">&lt;date variable="issued" delimiter=" ">&lt;date-part name="year"/>&lt;date-part name="month" form="short" strip-periods="true"/>&lt;/date>&lt;text macro="accessed-date" prefix=" "/>&lt;/else-if>&lt;else-if type="patent">&lt;group suffix=".">&lt;group delimiter=", ">&lt;text variable="number"/>&lt;date variable="issued">&lt;date-part name="year"/>&lt;/date>&lt;/group>&lt;text macro="accessed-date" prefix=" "/>&lt;/group>&lt;/else-if>&lt;else-if type="speech">&lt;group delimiter="; ">&lt;group delimiter=" ">&lt;date variable="issued" delimiter=" ">&lt;date-part name="year"/>&lt;date-part name="month" form="short" strip-periods="true"/>&lt;date-part name="day"/>&lt;/date>&lt;text macro="accessed-date"/>&lt;/group>&lt;text variable="event-place"/>&lt;/group>&lt;/else-if>&lt;else>&lt;group suffix=".">&lt;date variable="issued">&lt;date-part name="year"/>&lt;/date>&lt;text macro="accessed-date" prefix=" "/>&lt;/group>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="pages">&lt;choose>&lt;if type="article-journal article-magazine article-newspaper review review-book" match="any">&lt;text variable="page" prefix=":"/>&lt;/if>&lt;else-if type="book" match="any">&lt;text variable="number-of-pages" prefix=" "/>&lt;choose>&lt;if is-numeric="number-of-pages">&lt;label variable="number-of-pages" form="short" prefix=" " plural="never"/>&lt;/if>&lt;/choose>&lt;/else-if>&lt;else>&lt;group prefix=" " delimiter=" ">&lt;label variable="page" form="short" plural="never"/>&lt;text variable="page"/>&lt;/group>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="journal-location">&lt;choose>&lt;if type="article-journal article-magazine review review-book" match="any">&lt;text variable="volume"/>&lt;text variable="issue" prefix="(" suffix=")"/>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="collection-details">&lt;choose>&lt;if type="article-journal article-magazine article-newspaper review review-book" match="none">&lt;choose>&lt;if variable="collection-title">&lt;group delimiter=" " prefix="(" suffix=")">&lt;names variable="collection-editor" suffix=".">&lt;name sort-separator=" " initialize-with="" name-as-sort-order="all" delimiter=", " delimiter-precedes-last="always"/>&lt;label form="long" prefix=", "/>&lt;/names>&lt;group delimiter="; ">&lt;text variable="collection-title"/>&lt;group delimiter=" ">&lt;label variable="volume" form="short"/>&lt;text variable="volume"/>&lt;/group>&lt;/group>&lt;/group>&lt;/if>&lt;/choose>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="report-details">&lt;choose>&lt;if type="report">&lt;text variable="number" prefix="Report No.: "/>&lt;/if>&lt;/choose>&lt;/macro>&lt;citation collapse="citation-number">'+
'&lt;sort>&lt;key variable="citation-number"/>&lt;/sort>&lt;layout prefix="(" suffix=")" delimiter=",">&lt;text variable="citation-number"/>&lt;/layout>&lt;/citation>&lt;bibliography et-al-min="7" et-al-use-first="6" second-field-align="flush">&lt;layout>&lt;text variable="citation-number" suffix=". "/>&lt;group delimiter=". " suffix=". ">&lt;text macro="author"/>&lt;text macro="title"/>&lt;/group>&lt;group delimiter=" " suffix=". ">&lt;group delimiter=": ">&lt;text macro="chapter-marker"/>&lt;group delimiter=" ">&lt;text macro="editor"/>&lt;text macro="container-title"/>&lt;/group>&lt;/group>&lt;text macro="publisher"/>&lt;group>&lt;text macro="date"/>&lt;text macro="journal-location"/>&lt;text macro="pages"/>&lt;/group>&lt;/group>&lt;text macro="collection-details" suffix=". "/>&lt;text macro="report-details" suffix=". "/>&lt;text macro="access"/>&lt;/layout>&lt;/bibliography>&lt;/style>'
, harvard1: '&lt;?xml version="1.0" encoding="utf-8"?>&lt;style xmlns="http://purl.org/net/xbiblio/csl" class="in-text" version="1.0" demote-non-dropping-particle="sort-only">&lt;info>&lt;title>Harvard Reference format 1 (author-date)&lt;/title>&lt;id>http://www.zotero.org/styles/harvard1&lt;/id>&lt;link href="http://www.zotero.org/styles/harvard1" rel="self"/>&lt;link href="http://libweb.anglia.ac.uk/referencing/harvard.htm" rel="documentation"/>&lt;author>&lt;name>Julian Onions&lt;/name>&lt;email>julian.onions@gmail.com&lt;/email>&lt;/author>&lt;category citation-format="author-date"/>&lt;category field="generic-base"/>&lt;summary>The Harvard author-date style&lt;/summary>&lt;updated>2012-09-27T22:06:38+00:00&lt;/updated>&lt;rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License&lt;/rights>&lt;/info>&lt;macro name="editor">&lt;names variable="editor" delimiter=", ">&lt;name and="symbol" initialize-with=". " delimiter=", "/>&lt;label form="short" prefix=", " text-case="lowercase"/>&lt;/names>&lt;/macro>&lt;macro name="anon">&lt;text term="anonymous" form="short" text-case="capitalize-first" strip-periods="true"/>&lt;/macro>&lt;macro name="author">&lt;names variable="author">&lt;name name-as-sort-order="all" and="symbol" sort-separator=", " initialize-with="." delimiter-precedes-last="never" delimiter=", "/>&lt;label form="short" prefix=" " text-case="lowercase"/>&lt;substitute>&lt;names variable="editor"/>&lt;text macro="anon"/>&lt;/substitute>&lt;/names>&lt;/macro>&lt;macro name="author-short">&lt;names variable="author">&lt;name form="short" and="symbol" delimiter=", " delimiter-precedes-last="never" initialize-with=". "/>&lt;substitute>&lt;names variable="editor"/>&lt;names variable="translator"/>&lt;text macro="anon"/>&lt;/substitute>&lt;/names>&lt;/macro>&lt;macro name="access">&lt;choose>&lt;if variable="URL">&lt;text value="Available at:" suffix=" "/>&lt;text variable="URL"/>&lt;group prefix=" [" suffix="]">&lt;text term="accessed" text-case="capitalize-first" suffix=" "/>&lt;date variable="accessed">&lt;date-part name="month" suffix=" "/>&lt;date-part name="day" suffix=", "/>&lt;date-part name="year"/>&lt;/date>&lt;/group>&lt;/if>&lt;/choose>&lt;/macro>&lt;macro name="title">&lt;choose>&lt;if type="bill book graphic legal_case legislation motion_picture report song thesis" match="any">&lt;text variable="title" font-style="italic"/>&lt;/if>&lt;else>&lt;text variable="title"/>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="publisher">&lt;group delimiter=": ">&lt;text variable="publisher-place"/>&lt;text variable="publisher"/>&lt;/group>&lt;/macro>&lt;macro name="year-date">&lt;choose>&lt;if variable="issued">&lt;date variable="issued">&lt;date-part name="year"/>&lt;/date>&lt;/if>&lt;else>&lt;text term="no date" form="short"/>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="edition">&lt;choose>&lt;if is-numeric="edition">&lt;group delimiter=" ">&lt;number variable="edition" form="ordinal"/>&lt;text term="edition" form="short"/>&lt;/group>&lt;/if>&lt;else>&lt;text variable="edition" suffix="."/>&lt;/else>&lt;/choose>&lt;/macro>&lt;macro name="pages">&lt;group>&lt;label variable="page" form="short" suffix=" "/>&lt;text variable="page"/>&lt;/group>&lt;/macro>&lt;citation et-al-min="3" et-al-use-first="1" disambiguate-add-year-suffix="true" disambiguate-add-names="true" disambiguate-add-givenname="true">&lt;layout prefix="(" suffix=")" delimiter="; ">&lt;group delimiter=", ">&lt;group delimiter=" ">&lt;text macro="author-short"/>&lt;text macro="year-date"/>&lt;/group>&lt;group>&lt;label variable="locator" form="short"/>&lt;text variable="locator"/>&lt;/group>&lt;/group>&lt;/layout>&lt;/citation>&lt;bibliography hanging-indent="true" et-al-min="4" et-al-use-first="1">&lt;sort>&lt;key macro="author"/>&lt;key variable="title"/>&lt;/sort>&lt;layout>&lt;text macro="author" suffix=","/>&lt;date variable="issued" prefix=" " suffix=".">&lt;date-part name="year"/>&lt;/date>&lt;choose>&lt;if type="bill book graphic legal_case legislation motion_picture report song" match="any">&lt;group prefix=" " delimiter=" " suffix=",">&lt;text macro="title"/>&lt;text macro="edition"/>&lt;text macro="editor"/>&lt;/group>&lt;text prefix=" " suffix="." macro="publisher"/>&lt;/if>&lt;else-if type="chapter paper-conference" match="any">&lt;text macro="title" prefix=" " suffix="."/>&lt;group prefix=" " delimiter=" ">&lt;text term="in" text-case="capitalize-first"/>'+
'&lt;text macro="editor"/>&lt;text variable="container-title" font-style="italic" suffix="."/>&lt;text variable="collection-title" suffix="."/>&lt;text variable="event" suffix="."/>&lt;group suffix="." delimiter=", ">&lt;text macro="publisher" prefix=" "/>&lt;text macro="pages"/>&lt;/group>&lt;/group>&lt;/else-if>&lt;else-if type="thesis">&lt;group prefix=" " suffix="." delimiter=". ">&lt;text macro="title"/>&lt;text variable="genre"/>&lt;text macro="publisher"/>&lt;/group>&lt;/else-if>&lt;else>&lt;group suffix=".">&lt;text macro="title" prefix=" "/>&lt;text macro="editor" prefix=" "/>&lt;/group>&lt;group prefix=" " suffix=".">&lt;text variable="container-title" font-style="italic"/>&lt;group prefix=", ">&lt;text variable="volume"/>&lt;text variable="issue" prefix="(" suffix=")"/>&lt;/group>&lt;group prefix=", ">&lt;label variable="page" form="short"/>&lt;text variable="page"/>&lt;/group>&lt;/group>&lt;/else>&lt;/choose>&lt;text prefix=" " macro="access" suffix="."/>&lt;/layout>&lt;/bibliography>&lt;/style>'
}

/**
 * Object containing CSL locales
 * 
 * Locales from the [CSL Project](http://citationstyles.org/)  
 * [REPO](https://github.com/citation-style-language/locales)
 * 
 * Accesed 10/22/2016
 * 
 * @access private
 * @constant varCSLLocales
 * @default
 */
var varCSLLocales = {
  'en-US': '&lt;?xml version="1.0" encoding="utf-8"?>&lt;locale xmlns="http://purl.org/net/xbiblio/csl" version="1.0" xml:lang="en-US">&lt;info>&lt;rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License&lt;/rights>&lt;updated>2015-10-10T23:31:02+00:00&lt;/updated>&lt;/info>&lt;style-options punctuation-in-quote="true"/>&lt;date form="text">&lt;date-part name="month" suffix=" "/>&lt;date-part name="day" suffix=", "/>&lt;date-part name="year"/>&lt;/date>&lt;date form="numeric">&lt;date-part name="month" form="numeric-leading-zeros" suffix="/"/>&lt;date-part name="day" form="numeric-leading-zeros" suffix="/"/>&lt;date-part name="year"/>&lt;/date>&lt;terms>&lt;term name="accessed">accessed&lt;/term>&lt;term name="and">and&lt;/term>&lt;term name="and others">and others&lt;/term>&lt;term name="anonymous">anonymous&lt;/term>&lt;term name="anonymous" form="short">anon.&lt;/term>&lt;term name="at">at&lt;/term>&lt;term name="available at">available at&lt;/term>&lt;term name="by">by&lt;/term>&lt;term name="circa">circa&lt;/term>&lt;term name="circa" form="short">c.&lt;/term>&lt;term name="cited">cited&lt;/term>&lt;term name="edition">&lt;single>edition&lt;/single>&lt;multiple>editions&lt;/multiple>&lt;/term>&lt;term name="edition" form="short">ed.&lt;/term>&lt;term name="et-al">et al.&lt;/term>&lt;term name="forthcoming">forthcoming&lt;/term>&lt;term name="from">from&lt;/term>&lt;term name="ibid">ibid.&lt;/term>&lt;term name="in">in&lt;/term>&lt;term name="in press">in press&lt;/term>&lt;term name="internet">internet&lt;/term>&lt;term name="interview">interview&lt;/term>&lt;term name="letter">letter&lt;/term>&lt;term name="no date">no date&lt;/term>&lt;term name="no date" form="short">n.d.&lt;/term>&lt;term name="online">online&lt;/term>&lt;term name="presented at">presented at the&lt;/term>&lt;term name="reference">&lt;single>reference&lt;/single>&lt;multiple>references&lt;/multiple>&lt;/term>&lt;term name="reference" form="short">&lt;single>ref.&lt;/single>&lt;multiple>refs.&lt;/multiple>&lt;/term>&lt;term name="retrieved">retrieved&lt;/term>&lt;term name="scale">scale&lt;/term>&lt;term name="version">version&lt;/term>&lt;term name="ad">AD&lt;/term>&lt;term name="bc">BC&lt;/term>&lt;term name="open-quote">&lt;/term>&lt;term name="close-quote">&lt;/term>&lt;term name="open-inner-quote">&lt;/term>&lt;term name="close-inner-quote">&lt;/term>&lt;term name="page-range-delimiter">&lt;/term>&lt;term name="ordinal">th&lt;/term>&lt;term name="ordinal-01">st&lt;/term>&lt;term name="ordinal-02">nd&lt;/term>&lt;term name="ordinal-03">rd&lt;/term>&lt;term name="ordinal-11">th&lt;/term>&lt;term name="ordinal-12">th&lt;/term>&lt;term name="ordinal-13">th&lt;/term>&lt;term name="long-ordinal-01">first&lt;/term>&lt;term name="long-ordinal-02">second&lt;/term>&lt;term name="long-ordinal-03">third&lt;/term>&lt;term name="long-ordinal-04">fourth&lt;/term>&lt;term name="long-ordinal-05">fifth&lt;/term>&lt;term name="long-ordinal-06">sixth&lt;/term>&lt;term name="long-ordinal-07">seventh&lt;/term>&lt;term name="long-ordinal-08">eighth&lt;/term>&lt;term name="long-ordinal-09">ninth&lt;/term>&lt;term name="long-ordinal-10">tenth&lt;/term>&lt;term name="book">&lt;single>book&lt;/single>&lt;multiple>books&lt;/multiple>&lt;/term>&lt;term name="chapter">&lt;single>chapter&lt;/single>&lt;multiple>chapters&lt;/multiple>&lt;/term>&lt;term name="column">&lt;single>column&lt;/single>&lt;multiple>columns&lt;/multiple>&lt;/term>&lt;term name="figure">&lt;single>figure&lt;/single>&lt;multiple>figures&lt;/multiple>&lt;/term>&lt;term name="folio">&lt;single>folio&lt;/single>&lt;multiple>folios&lt;/multiple>&lt;/term>&lt;term name="issue">&lt;single>number&lt;/single>&lt;multiple>numbers&lt;/multiple>&lt;/term>&lt;term name="line">&lt;single>line&lt;/single>&lt;multiple>lines&lt;/multiple>&lt;/term>&lt;term name="note">&lt;single>note&lt;/single>&lt;multiple>notes&lt;/multiple>&lt;/term>&lt;term name="opus">&lt;single>opus&lt;/single>&lt;multiple>opera&lt;/multiple>&lt;/term>&lt;term name="page">&lt;single>page&lt;/single>&lt;multiple>pages&lt;/multiple>&lt;/term>&lt;term name="number-of-pages">&lt;single>page&lt;/single>&lt;multiple>pages&lt;/multiple>&lt;/term>&lt;term name="paragraph">&lt;single>paragraph&lt;/single>&lt;multiple>paragraphs&lt;/multiple>&lt;/term>&lt;term name="part">&lt;single>part&lt;/single>&lt;multiple>parts&lt;/multiple>&lt;/term>&lt;term name="section">&lt;single>section&lt;/single>&lt;multiple>sections&lt;/multiple>&lt;/term>&lt;term name="sub verbo">&lt;single>sub verbo&lt;/single>&lt;multiple>sub verbis&lt;/multiple>&lt;/term>&lt;term name="verse">&lt;single>verse&lt;/single>&lt;multiple>verses&lt;/multiple>'+
'&lt;/term>&lt;term name="volume">&lt;single>volume&lt;/single>&lt;multiple>volumes&lt;/multiple>&lt;/term>&lt;term name="book" form="short">&lt;single>bk.&lt;/single>&lt;multiple>bks.&lt;/multiple>&lt;/term>&lt;term name="chapter" form="short">&lt;single>chap.&lt;/single>&lt;multiple>chaps.&lt;/multiple>&lt;/term>&lt;term name="column" form="short">&lt;single>col.&lt;/single>&lt;multiple>cols.&lt;/multiple>&lt;/term>&lt;term name="figure" form="short">&lt;single>fig.&lt;/single>&lt;multiple>figs.&lt;/multiple>&lt;/term>&lt;term name="folio" form="short">&lt;single>fol.&lt;/single>&lt;multiple>fols.&lt;/multiple>&lt;/term>&lt;term name="issue" form="short">&lt;single>no.&lt;/single>&lt;multiple>nos.&lt;/multiple>&lt;/term>&lt;term name="line" form="short">&lt;single>l.&lt;/single>&lt;multiple>ll.&lt;/multiple>&lt;/term>&lt;term name="note" form="short">&lt;single>n.&lt;/single>&lt;multiple>nn.&lt;/multiple>&lt;/term>&lt;term name="opus" form="short">&lt;single>op.&lt;/single>&lt;multiple>opp.&lt;/multiple>&lt;/term>&lt;term name="page" form="short">&lt;single>p.&lt;/single>&lt;multiple>pp.&lt;/multiple>&lt;/term>&lt;term name="number-of-pages" form="short">&lt;single>p.&lt;/single>&lt;multiple>pp.&lt;/multiple>&lt;/term>&lt;term name="paragraph" form="short">&lt;single>para.&lt;/single>&lt;multiple>paras.&lt;/multiple>&lt;/term>&lt;term name="part" form="short">&lt;single>pt.&lt;/single>&lt;multiple>pts.&lt;/multiple>&lt;/term>&lt;term name="section" form="short">&lt;single>sec.&lt;/single>&lt;multiple>secs.&lt;/multiple>&lt;/term>&lt;term name="sub verbo" form="short">&lt;single>s.v.&lt;/single>&lt;multiple>s.vv.&lt;/multiple>&lt;/term>&lt;term name="verse" form="short">&lt;single>v.&lt;/single>&lt;multiple>vv.&lt;/multiple>&lt;/term>&lt;term name="volume" form="short">&lt;single>vol.&lt;/single>&lt;multiple>vols.&lt;/multiple>&lt;/term>&lt;term name="paragraph" form="symbol">&lt;single>&lt;/single>&lt;multiple>&lt;/multiple>&lt;/term>&lt;term name="section" form="symbol">&lt;single>&lt;/single>&lt;multiple>&lt;/multiple>&lt;/term>&lt;term name="director">&lt;single>director&lt;/single>&lt;multiple>directors&lt;/multiple>&lt;/term>&lt;term name="editor">&lt;single>editor&lt;/single>&lt;multiple>editors&lt;/multiple>&lt;/term>&lt;term name="editorial-director">&lt;single>editor&lt;/single>&lt;multiple>editors&lt;/multiple>&lt;/term>&lt;term name="illustrator">&lt;single>illustrator&lt;/single>&lt;multiple>illustrators&lt;/multiple>&lt;/term>&lt;term name="translator">&lt;single>translator&lt;/single>&lt;multiple>translators&lt;/multiple>&lt;/term>&lt;term name="editortranslator">&lt;single>editor &amp;amp; translator&lt;/single>&lt;multiple>editors &amp;amp; translators&lt;/multiple>&lt;/term>&lt;term name="director" form="short">&lt;single>dir.&lt;/single>&lt;multiple>dirs.&lt;/multiple>&lt;/term>&lt;term name="editor" form="short">&lt;single>ed.&lt;/single>&lt;multiple>eds.&lt;/multiple>&lt;/term>&lt;term name="editorial-director" form="short">&lt;single>ed.&lt;/single>&lt;multiple>eds.&lt;/multiple>&lt;/term>&lt;term name="illustrator" form="short">&lt;single>ill.&lt;/single>&lt;multiple>ills.&lt;/multiple>&lt;/term>&lt;term name="translator" form="short">&lt;single>tran.&lt;/single>&lt;multiple>trans.&lt;/multiple>&lt;/term>&lt;term name="editortranslator" form="short">&lt;single>ed. &amp;amp; tran.&lt;/single>&lt;multiple>eds. &amp;amp; trans.&lt;/multiple>&lt;/term>&lt;term name="container-author" form="verb">by&lt;/term>&lt;term name="director" form="verb">directed by&lt;/term>&lt;term name="editor" form="verb">edited by&lt;/term>&lt;term name="editorial-director" form="verb">edited by&lt;/term>&lt;term name="illustrator" form="verb">illustrated by&lt;/term>&lt;term name="interviewer" form="verb">interview by&lt;/term>&lt;term name="recipient" form="verb">to&lt;/term>&lt;term name="reviewed-author" form="verb">by&lt;/term>&lt;term name="translator" form="verb">translated by&lt;/term>&lt;term name="editortranslator" form="verb">edited &amp;amp; translated by&lt;/term>&lt;term name="director" form="verb-short">dir. by&lt;/term>&lt;term name="editor" form="verb-short">ed. by&lt;/term>&lt;term name="editorial-director" form="verb-short">ed. by&lt;/term>&lt;term name="illustrator" form="verb-short">illus. by&lt;/term>&lt;term name="translator" form="verb-short">trans. by&lt;/term>&lt;term name="editortranslator" form="verb-short">ed. &amp;amp; trans. by&lt;/term>&lt;term name="month-01">January&lt;/term>&lt;term name="month-02">February&lt;/term>&lt;term name="month-03">March&lt;/term>&lt;term name="month-04">April&lt;/term>&lt;term name="month-05">May&lt;/term>&lt;term name="month-06">June&lt;/term>&lt;term name="month-07">July&lt;/term>&lt;term name="month-08">August&lt;/term>&lt;term name="month-09">September&lt;/term>'+
'&lt;term name="month-10">October&lt;/term>&lt;term name="month-11">November&lt;/term>&lt;term name="month-12">December&lt;/term>&lt;term name="month-01" form="short">Jan.&lt;/term>&lt;term name="month-02" form="short">Feb.&lt;/term>&lt;term name="month-03" form="short">Mar.&lt;/term>&lt;term name="month-04" form="short">Apr.&lt;/term>&lt;term name="month-05" form="short">May&lt;/term>&lt;term name="month-06" form="short">Jun.&lt;/term>&lt;term name="month-07" form="short">Jul.&lt;/term>&lt;term name="month-08" form="short">Aug.&lt;/term>&lt;term name="month-09" form="short">Sep.&lt;/term>&lt;term name="month-10" form="short">Oct.&lt;/term>&lt;term name="month-11" form="short">Nov.&lt;/term>&lt;term name="month-12" form="short">Dec.&lt;/term>&lt;term name="season-01">Spring&lt;/term>&lt;term name="season-02">Summer&lt;/term>&lt;term name="season-03">Autumn&lt;/term>&lt;term name="season-04">Winter&lt;/term>&lt;/terms>&lt;/locale>'
, 'nl-NL': '&lt;?xml version="1.0" encoding="utf-8"?>&lt;locale xmlns="http://purl.org/net/xbiblio/csl" version="1.0" xml:lang="nl-NL">&lt;info>&lt;translator>&lt;name>Rintze Zelle&lt;/name>&lt;uri>http://twitter.com/rintzezelle&lt;/uri>&lt;/translator>&lt;rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License&lt;/rights>&lt;updated>2012-07-04T23:31:02+00:00&lt;/updated>&lt;/info>&lt;style-options punctuation-in-quote="false"/>&lt;date form="text">&lt;date-part name="day" suffix=" "/>&lt;date-part name="month" suffix=" "/>&lt;date-part name="year"/>&lt;/date>&lt;date form="numeric">&lt;date-part name="day" suffix="-" range-delimiter="/"/>&lt;date-part name="month" form="numeric" suffix="-" range-delimiter="/"/>&lt;date-part name="year"/>&lt;/date>&lt;terms>&lt;term name="accessed">geraadpleegd&lt;/term>&lt;term name="and">en&lt;/term>&lt;term name="and others">en anderen&lt;/term>&lt;term name="anonymous">anoniem&lt;/term>&lt;term name="anonymous" form="short">anon.&lt;/term>&lt;term name="at">bij&lt;/term>&lt;term name="available at">beschikbaar op&lt;/term>&lt;term name="by">door&lt;/term>&lt;term name="circa">circa&lt;/term>&lt;term name="circa" form="short">c.&lt;/term>&lt;term name="cited">geciteerd&lt;/term>&lt;term name="edition">&lt;single>editie&lt;/single>&lt;multiple>edities&lt;/multiple>&lt;/term>&lt;term name="edition" form="short">ed.&lt;/term>&lt;term name="et-al">e.a.&lt;/term>&lt;term name="forthcoming">in voorbereiding&lt;/term>&lt;term name="from">van&lt;/term>&lt;term name="ibid">ibid.&lt;/term>&lt;term name="in">in&lt;/term>&lt;term name="in press">in druk&lt;/term>&lt;term name="internet">internet&lt;/term>&lt;term name="interview">interview&lt;/term>&lt;term name="letter">brief&lt;/term>&lt;term name="no date">zonder datum&lt;/term>&lt;term name="no date" form="short">z.d.&lt;/term>&lt;term name="online">online&lt;/term>&lt;term name="presented at">gepresenteerd bij&lt;/term>&lt;term name="reference">&lt;single>referentie&lt;/single>&lt;multiple>referenties&lt;/multiple>&lt;/term>&lt;term name="reference" form="short">&lt;single>ref.&lt;/single>&lt;multiple>refs.&lt;/multiple>&lt;/term>&lt;term name="retrieved">geraadpleegd&lt;/term>&lt;term name="scale">schaal&lt;/term>&lt;term name="version">versie&lt;/term>&lt;term name="ad">AD&lt;/term>&lt;term name="bc">BC&lt;/term>&lt;term name="open-quote">&lt;/term>&lt;term name="close-quote">&lt;/term>&lt;term name="open-inner-quote">&lt;/term>&lt;term name="close-inner-quote">&lt;/term>&lt;term name="page-range-delimiter">&lt;/term>&lt;term name="ordinal">ste&lt;/term>&lt;term name="ordinal-00" match="whole-number">de&lt;/term>&lt;term name="ordinal-02" match="last-two-digits">de&lt;/term>&lt;term name="ordinal-03" match="last-two-digits">de&lt;/term>&lt;term name="ordinal-04" match="last-two-digits">de&lt;/term>&lt;term name="ordinal-05" match="last-two-digits">de&lt;/term>&lt;term name="ordinal-06" match="last-two-digits">de&lt;/term>&lt;term name="ordinal-07" match="last-two-digits">de&lt;/term>&lt;term name="ordinal-09" match="last-two-digits">de&lt;/term>&lt;term name="ordinal-10">de&lt;/term>&lt;term name="ordinal-11">de&lt;/term>&lt;term name="ordinal-12">de&lt;/term>&lt;term name="ordinal-13">de&lt;/term>&lt;term name="ordinal-14">de&lt;/term>&lt;term name="ordinal-15">de&lt;/term>&lt;term name="ordinal-16">de&lt;/term>&lt;term name="ordinal-17">de&lt;/term>&lt;term name="ordinal-18">de&lt;/term>&lt;term name="ordinal-19">de&lt;/term>&lt;term name="long-ordinal-01">eerste&lt;/term>&lt;term name="long-ordinal-02">tweede&lt;/term>&lt;term name="long-ordinal-03">derde&lt;/term>&lt;term name="long-ordinal-04">vierde&lt;/term>&lt;term name="long-ordinal-05">vijfde&lt;/term>&lt;term name="long-ordinal-06">zesde&lt;/term>&lt;term name="long-ordinal-07">zevende&lt;/term>&lt;term name="long-ordinal-08">achtste&lt;/term>&lt;term name="long-ordinal-09">negende&lt;/term>&lt;term name="long-ordinal-10">tiende&lt;/term>&lt;term name="book">&lt;single>boek&lt;/single>&lt;multiple>boeken&lt;/multiple>&lt;/term>&lt;term name="chapter">&lt;single>hoofdstuk&lt;/single>&lt;multiple>hoofdstukken&lt;/multiple>&lt;/term>&lt;term name="column">&lt;single>column&lt;/single>&lt;multiple>columns&lt;/multiple>&lt;/term>&lt;term name="figure">&lt;single>figuur&lt;/single>&lt;multiple>figuren&lt;/multiple>&lt;/term>&lt;term name="folio">&lt;single>folio&lt;/single>&lt;multiple>folio\'s&lt;/multiple>&lt;/term>&lt;term name="issue">&lt;single>nummer&lt;/single>&lt;multiple>nummers&lt;/multiple>&lt;/term>&lt;term name="line">&lt;single>regel&lt;/single>&lt;multiple>regels&lt;/multiple>'+
'&lt;/term>&lt;term name="note">&lt;single>aantekening&lt;/single>&lt;multiple>aantekeningen&lt;/multiple>&lt;/term>&lt;term name="opus">&lt;single>opus&lt;/single>&lt;multiple>opera&lt;/multiple>&lt;/term>&lt;term name="page">&lt;single>pagina&lt;/single>&lt;multiple>pagina\'s&lt;/multiple>&lt;/term>&lt;term name="number-of-pages">&lt;single>pagina&lt;/single>&lt;multiple>pagina\'s&lt;/multiple>&lt;/term>&lt;term name="paragraph">&lt;single>paragraaf&lt;/single>&lt;multiple>paragrafen&lt;/multiple>&lt;/term>&lt;term name="part">&lt;single>deel&lt;/single>&lt;multiple>delen&lt;/multiple>&lt;/term>&lt;term name="section">&lt;single>sectie&lt;/single>&lt;multiple>secties&lt;/multiple>&lt;/term>&lt;term name="sub verbo">&lt;single>sub verbo&lt;/single>&lt;multiple>sub verbis&lt;/multiple>&lt;/term>&lt;term name="verse">&lt;single>vers&lt;/single>&lt;multiple>versen&lt;/multiple>&lt;/term>&lt;term name="volume">&lt;single>volume&lt;/single>&lt;multiple>volumes&lt;/multiple>&lt;/term>&lt;term name="book" form="short">bk.&lt;/term>&lt;term name="chapter" form="short">hfdst.&lt;/term>&lt;term name="column" form="short">col.&lt;/term>&lt;term name="figure" form="short">fig.&lt;/term>&lt;term name="folio" form="short">f.&lt;/term>&lt;term name="issue" form="short">nr.&lt;/term>&lt;term name="line" form="short">l.&lt;/term>&lt;term name="note" form="short">n.&lt;/term>&lt;term name="opus" form="short">op.&lt;/term>&lt;term name="page" form="short">&lt;single>p.&lt;/single>&lt;multiple>pp.&lt;/multiple>&lt;/term>&lt;term name="number-of-pages" form="short">&lt;single>p.&lt;/single>&lt;multiple>pp.&lt;/multiple>&lt;/term>&lt;term name="paragraph" form="short">par.&lt;/term>&lt;term name="part" form="short">deel&lt;/term>&lt;term name="section" form="short">sec.&lt;/term>&lt;term name="sub verbo" form="short">&lt;single>s.v.&lt;/single>&lt;multiple>s.vv.&lt;/multiple>&lt;/term>&lt;term name="verse" form="short">&lt;single>v.&lt;/single>&lt;multiple>vv.&lt;/multiple>&lt;/term>&lt;term name="volume" form="short">&lt;single>vol.&lt;/single>&lt;multiple>vols.&lt;/multiple>&lt;/term>&lt;term name="paragraph" form="symbol">&lt;single>&lt;/single>&lt;multiple>&lt;/multiple>&lt;/term>&lt;term name="section" form="symbol">&lt;single>&lt;/single>&lt;multiple>&lt;/multiple>&lt;/term>&lt;term name="director">&lt;single>regisseur&lt;/single>&lt;multiple>regisseurs&lt;/multiple>&lt;/term>&lt;term name="editor">&lt;single>redacteur&lt;/single>&lt;multiple>redacteuren&lt;/multiple>&lt;/term>&lt;term name="editorial-director">&lt;single>redacteur&lt;/single>&lt;multiple>redacteuren&lt;/multiple>&lt;/term>&lt;term name="illustrator">&lt;single>illustrator&lt;/single>&lt;multiple>illustrators&lt;/multiple>&lt;/term>&lt;term name="translator">&lt;single>vertaler&lt;/single>&lt;multiple>vertalers&lt;/multiple>&lt;/term>&lt;term name="editortranslator">&lt;single>redacteur &amp;amp; vertaler&lt;/single>&lt;multiple>redacteuren &amp;amp; vertalers&lt;/multiple>&lt;/term>&lt;term name="director" form="short">&lt;single>reg.&lt;/single>&lt;multiple>reg.&lt;/multiple>&lt;/term>&lt;term name="editor" form="short">&lt;single>red.&lt;/single>&lt;multiple>red.&lt;/multiple>&lt;/term>&lt;term name="editorial-director" form="short">&lt;single>red.&lt;/single>&lt;multiple>red.&lt;/multiple>&lt;/term>&lt;term name="illustrator" form="short">&lt;single>ill.&lt;/single>&lt;multiple>ill.&lt;/multiple>&lt;/term>&lt;term name="translator" form="short">&lt;single>vert.&lt;/single>&lt;multiple>vert.&lt;/multiple>&lt;/term>&lt;term name="editortranslator" form="short">&lt;single>red. &amp;amp; vert.&lt;/single>&lt;multiple>red. &amp;amp; vert.&lt;/multiple>&lt;/term>&lt;term name="container-author" form="verb">door&lt;/term>&lt;term name="director" form="verb">geregisseerd door&lt;/term>&lt;term name="editor" form="verb">bewerkt door&lt;/term>&lt;term name="editorial-director" form="verb">bewerkt door&lt;/term>&lt;term name="illustrator" form="verb">gellustreerd door&lt;/term>&lt;term name="interviewer" form="verb">genterviewd door&lt;/term>&lt;term name="recipient" form="verb">ontvangen door&lt;/term>&lt;term name="reviewed-author" form="verb">door&lt;/term>&lt;term name="translator" form="verb">vertaald door&lt;/term>&lt;term name="editortranslator" form="verb">bewerkt &amp;amp; vertaald door&lt;/term>&lt;term name="director" form="verb-short">geregisseerd door&lt;/term>&lt;term name="editor" form="verb-short">bewerkt door&lt;/term>&lt;term name="editorial-director" form="verb-short">bewerkt door&lt;/term>&lt;term name="illustrator" form="verb-short">gellustreerd door&lt;/term>&lt;term name="translator" form="verb-short">vertaald door&lt;/term>&lt;term name="editortranslator" form="verb-short">bewerkt &amp;amp; vertaald door&lt;/term>'+
'&lt;term name="month-01">januari&lt;/term>&lt;term name="month-02">februari&lt;/term>&lt;term name="month-03">maart&lt;/term>&lt;term name="month-04">april&lt;/term>&lt;term name="month-05">mei&lt;/term>&lt;term name="month-06">juni&lt;/term>&lt;term name="month-07">juli&lt;/term>&lt;term name="month-08">augustus&lt;/term>&lt;term name="month-09">september&lt;/term>&lt;term name="month-10">oktober&lt;/term>&lt;term name="month-11">november&lt;/term>&lt;term name="month-12">december&lt;/term>&lt;term name="month-01" form="short">jan.&lt;/term>&lt;term name="month-02" form="short">feb.&lt;/term>&lt;term name="month-03" form="short">mrt.&lt;/term>&lt;term name="month-04" form="short">apr.&lt;/term>&lt;term name="month-05" form="short">mei&lt;/term>&lt;term name="month-06" form="short">jun.&lt;/term>&lt;term name="month-07" form="short">jul.&lt;/term>&lt;term name="month-08" form="short">aug.&lt;/term>&lt;term name="month-09" form="short">sep.&lt;/term>&lt;term name="month-10" form="short">okt.&lt;/term>&lt;term name="month-11" form="short">nov.&lt;/term>&lt;term name="month-12" form="short">dec.&lt;/term>&lt;term name="season-01">lente&lt;/term>&lt;term name="season-02">zomer&lt;/term>&lt;term name="season-03">herst&lt;/term>&lt;term name="season-04">winter&lt;/term>&lt;/terms>&lt;/locale>'
, 'fr-FR': '&lt;?xml version="1.0" encoding="utf-8"?>&lt;locale xmlns="http://purl.org/net/xbiblio/csl" version="1.0" xml:lang="fr-FR">&lt;info>&lt;translator>&lt;name>Grgoire Colly&lt;/name>&lt;/translator>&lt;rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License&lt;/rights>&lt;updated>2012-07-04T23:31:02+00:00&lt;/updated>&lt;/info>&lt;style-options punctuation-in-quote="false" limit-day-ordinals-to-day-1="true"/>&lt;date form="text">&lt;date-part name="day" suffix=" "/>&lt;date-part name="month" suffix=" "/>&lt;date-part name="year"/>&lt;/date>&lt;date form="numeric">&lt;date-part name="day" form="numeric-leading-zeros" suffix="/"/>&lt;date-part name="month" form="numeric-leading-zeros" suffix="/"/>&lt;date-part name="year"/>&lt;/date>&lt;terms>&lt;term name="accessed">consult le&lt;/term>&lt;term name="and">et&lt;/term>&lt;term name="and others">et autres&lt;/term>&lt;term name="anonymous">anonyme&lt;/term>&lt;term name="anonymous" form="short">anon.&lt;/term>&lt;term name="at">sur&lt;/term>&lt;term name="available at">disponible sur&lt;/term>&lt;term name="by">par&lt;/term>&lt;term name="circa">vers&lt;/term>&lt;term name="circa" form="short">v.&lt;/term>&lt;term name="cited">cit&lt;/term>&lt;term name="edition" gender="feminine">&lt;single>dition&lt;/single>&lt;multiple>ditions&lt;/multiple>&lt;/term>&lt;term name="edition" form="short">d.&lt;/term>&lt;term name="et-al">et al.&lt;/term>&lt;term name="forthcoming"> paratre&lt;/term>&lt;term name="from"> l\'adresse&lt;/term>&lt;term name="ibid">ibid.&lt;/term>&lt;term name="in">in&lt;/term>&lt;term name="in press">sous presse&lt;/term>&lt;term name="internet">Internet&lt;/term>&lt;term name="interview">entretien&lt;/term>&lt;term name="letter">lettre&lt;/term>&lt;term name="no date">sans date&lt;/term>&lt;term name="no date" form="short">s.&amp;#160;d.&lt;/term>&lt;term name="online">en ligne&lt;/term>&lt;term name="presented at">prsent &lt;/term>&lt;term name="reference">&lt;single>rfrence&lt;/single>&lt;multiple>rfrences&lt;/multiple>&lt;/term>&lt;term name="reference" form="short">&lt;single>rf.&lt;/single>&lt;multiple>rf.&lt;/multiple>&lt;/term>&lt;term name="retrieved">consult&lt;/term>&lt;term name="scale">chelle&lt;/term>&lt;term name="version">version&lt;/term>&lt;term name="ad">apr. J.-C.&lt;/term>&lt;term name="bc">av. J.-C.&lt;/term>&lt;term name="open-quote">&amp;#160;&lt;/term>&lt;term name="close-quote">&amp;#160;&lt;/term>&lt;term name="open-inner-quote">&lt;/term>&lt;term name="close-inner-quote">&lt;/term>&lt;term name="page-range-delimiter">&amp;#8209;&lt;/term>&lt;term name="ordinal">&lt;/term>&lt;term name="ordinal-01" gender-form="feminine" match="whole-number">&lt;/term>&lt;term name="ordinal-01" gender-form="masculine" match="whole-number">&lt;/term>&lt;term name="long-ordinal-01">premier&lt;/term>&lt;term name="long-ordinal-02">deuxime&lt;/term>&lt;term name="long-ordinal-03">troisime&lt;/term>&lt;term name="long-ordinal-04">quatrime&lt;/term>&lt;term name="long-ordinal-05">cinquime&lt;/term>&lt;term name="long-ordinal-06">sixime&lt;/term>&lt;term name="long-ordinal-07">septime&lt;/term>&lt;term name="long-ordinal-08">huitime&lt;/term>&lt;term name="long-ordinal-09">neuvime&lt;/term>&lt;term name="long-ordinal-10">dixime&lt;/term>&lt;term name="book">&lt;single>livre&lt;/single>&lt;multiple>livres&lt;/multiple>&lt;/term>&lt;term name="chapter">&lt;single>chapitre&lt;/single>&lt;multiple>chapitres&lt;/multiple>&lt;/term>&lt;term name="column">&lt;single>colonne&lt;/single>&lt;multiple>colonnes&lt;/multiple>&lt;/term>&lt;term name="figure">&lt;single>figure&lt;/single>&lt;multiple>figures&lt;/multiple>&lt;/term>&lt;term name="folio">&lt;single>folio&lt;/single>&lt;multiple>folios&lt;/multiple>&lt;/term>&lt;term name="issue" gender="masculine">&lt;single>numro&lt;/single>&lt;multiple>numros&lt;/multiple>&lt;/term>&lt;term name="line">&lt;single>ligne&lt;/single>&lt;multiple>lignes&lt;/multiple>&lt;/term>&lt;term name="note">&lt;single>note&lt;/single>&lt;multiple>notes&lt;/multiple>&lt;/term>&lt;term name="opus">&lt;single>opus&lt;/single>&lt;multiple>opus&lt;/multiple>&lt;/term>&lt;term name="page">&lt;single>page&lt;/single>&lt;multiple>pages&lt;/multiple>&lt;/term>&lt;term name="number-of-pages">&lt;single>page&lt;/single>&lt;multiple>pages&lt;/multiple>&lt;/term>&lt;term name="paragraph">&lt;single>paragraphe&lt;/single>&lt;multiple>paragraphes&lt;/multiple>&lt;/term>&lt;term name="part">&lt;single>partie&lt;/single>&lt;multiple>parties&lt;/multiple>&lt;/term>&lt;term name="section">&lt;single>section&lt;/single>&lt;multiple>sections&lt;/multiple>'+
'&lt;/term>&lt;term name="sub verbo">&lt;single>sub verbo&lt;/single>&lt;multiple>sub verbis&lt;/multiple>&lt;/term>&lt;term name="verse">&lt;single>verset&lt;/single>&lt;multiple>versets&lt;/multiple>&lt;/term>&lt;term name="volume" gender="masculine">&lt;single>volume&lt;/single>&lt;multiple>volumes&lt;/multiple>&lt;/term>&lt;term name="book" form="short">liv.&lt;/term>&lt;term name="chapter" form="short">chap.&lt;/term>&lt;term name="column" form="short">col.&lt;/term>&lt;term name="figure" form="short">fig.&lt;/term>&lt;term name="folio" form="short">&lt;single>f&lt;/single>&lt;multiple>f&lt;/multiple>&lt;/term>&lt;term name="issue" form="short">&lt;single>n&lt;/single>&lt;multiple>n&lt;/multiple>&lt;/term>&lt;term name="line" form="short">l.&lt;/term>&lt;term name="note" form="short">n.&lt;/term>&lt;term name="opus" form="short">op.&lt;/term>&lt;term name="page" form="short">&lt;single>p.&lt;/single>&lt;multiple>p.&lt;/multiple>&lt;/term>&lt;term name="number-of-pages" form="short">&lt;single>p.&lt;/single>&lt;multiple>p.&lt;/multiple>&lt;/term>&lt;term name="paragraph" form="short">paragr.&lt;/term>&lt;term name="part" form="short">part.&lt;/term>&lt;term name="section" form="short">sect.&lt;/term>&lt;term name="sub verbo" form="short">&lt;single>s.&amp;#160;v.&lt;/single>&lt;multiple>s.&amp;#160;vv.&lt;/multiple>&lt;/term>&lt;term name="verse" form="short">&lt;single>v.&lt;/single>&lt;multiple>v.&lt;/multiple>&lt;/term>&lt;term name="volume" form="short">&lt;single>vol.&lt;/single>&lt;multiple>vol.&lt;/multiple>&lt;/term>&lt;term name="paragraph" form="symbol">&lt;single>&lt;/single>&lt;multiple>&lt;/multiple>&lt;/term>&lt;term name="section" form="symbol">&lt;single>&lt;/single>&lt;multiple>&lt;/multiple>&lt;/term>&lt;term name="director">&lt;single>ralisateur&lt;/single>&lt;multiple>ralisateurs&lt;/multiple>&lt;/term>&lt;term name="editor">&lt;single>diteur&lt;/single>&lt;multiple>diteurs&lt;/multiple>&lt;/term>&lt;term name="editorial-director">&lt;single>directeur&lt;/single>&lt;multiple>directeurs&lt;/multiple>&lt;/term>&lt;term name="illustrator">&lt;single>illustrateur&lt;/single>&lt;multiple>illustrateurs&lt;/multiple>&lt;/term>&lt;term name="translator">&lt;single>traducteur&lt;/single>&lt;multiple>traducteurs&lt;/multiple>&lt;/term>&lt;term name="editortranslator">&lt;single>diteur et traducteur&lt;/single>&lt;multiple>diteurs et traducteurs&lt;/multiple>&lt;/term>&lt;term name="director" form="short">&lt;single>ral.&lt;/single>&lt;multiple>ral.&lt;/multiple>&lt;/term>&lt;term name="editor" form="short">&lt;single>d.&lt;/single>&lt;multiple>d.&lt;/multiple>&lt;/term>&lt;term name="editorial-director" form="short">&lt;single>dir.&lt;/single>&lt;multiple>dir.&lt;/multiple>&lt;/term>&lt;term name="illustrator" form="short">&lt;single>ill.&lt;/single>&lt;multiple>ill.&lt;/multiple>&lt;/term>&lt;term name="translator" form="short">&lt;single>trad.&lt;/single>&lt;multiple>trad.&lt;/multiple>&lt;/term>&lt;term name="editortranslator" form="short">&lt;single>d. et trad.&lt;/single>&lt;multiple>d. et trad.&lt;/multiple>&lt;/term>&lt;term name="container-author" form="verb">par&lt;/term>&lt;term name="director" form="verb">ralis par&lt;/term>&lt;term name="editor" form="verb">dit par&lt;/term>&lt;term name="editorial-director" form="verb">sous la direction de&lt;/term>&lt;term name="illustrator" form="verb">illustr par&lt;/term>&lt;term name="interviewer" form="verb">entretien ralis par&lt;/term>&lt;term name="recipient" form="verb">&lt;/term>&lt;term name="reviewed-author" form="verb">par&lt;/term>&lt;term name="translator" form="verb">traduit par&lt;/term>&lt;term name="editortranslator" form="verb">dit et traduit par&lt;/term>&lt;term name="director" form="verb-short">ral. par&lt;/term>&lt;term name="editor" form="verb-short">d. par&lt;/term>&lt;term name="editorial-director" form="verb-short">ss la dir. de&lt;/term>&lt;term name="illustrator" form="verb-short">ill. par&lt;/term>&lt;term name="translator" form="verb-short">trad. par&lt;/term>&lt;term name="editortranslator" form="verb-short">d. et trad. par&lt;/term>&lt;term name="month-01" gender="masculine">janvier&lt;/term>&lt;term name="month-02" gender="masculine">fvrier&lt;/term>&lt;term name="month-03" gender="masculine">mars&lt;/term>&lt;term name="month-04" gender="masculine">avril&lt;/term>&lt;term name="month-05" gender="masculine">mai&lt;/term>&lt;term name="month-06" gender="masculine">juin&lt;/term>&lt;term name="month-07" gender="masculine">juillet&lt;/term>&lt;term name="month-08" gender="masculine">aot&lt;/term>&lt;term name="month-09" gender="masculine">septembre&lt;/term>&lt;term name="month-10" gender="masculine">'+
'octobre&lt;/term>&lt;term name="month-11" gender="masculine">novembre&lt;/term>&lt;term name="month-12" gender="masculine">dcembre&lt;/term>&lt;term name="month-01" form="short">janv.&lt;/term>&lt;term name="month-02" form="short">fvr.&lt;/term>&lt;term name="month-03" form="short">mars&lt;/term>&lt;term name="month-04" form="short">avr.&lt;/term>&lt;term name="month-05" form="short">mai&lt;/term>&lt;term name="month-06" form="short">juin&lt;/term>&lt;term name="month-07" form="short">juill.&lt;/term>&lt;term name="month-08" form="short">aot&lt;/term>&lt;term name="month-09" form="short">sept.&lt;/term>&lt;term name="month-10" form="short">oct.&lt;/term>&lt;term name="month-11" form="short">nov.&lt;/term>&lt;term name="month-12" form="short">dc.&lt;/term>&lt;term name="season-01">printemps&lt;/term>&lt;term name="season-02">t&lt;/term>&lt;term name="season-03">automne&lt;/term>&lt;term name="season-04">hiver&lt;/term>&lt;/terms>&lt;/locale>'
, 'de-DE': '&lt;?xml version="1.0" encoding="utf-8"?>&lt;locale xmlns="http://purl.org/net/xbiblio/csl" version="1.0" xml:lang="de-DE">&lt;info>&lt;rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License&lt;/rights>&lt;updated>2012-07-04T23:31:02+00:00&lt;/updated>&lt;/info>&lt;style-options punctuation-in-quote="false"/>&lt;date form="text">&lt;date-part name="day" form="ordinal" suffix=" "/>&lt;date-part name="month" suffix=" "/>&lt;date-part name="year"/>&lt;/date>&lt;date form="numeric">&lt;date-part name="day" form="numeric-leading-zeros" suffix="."/>&lt;date-part name="month" form="numeric-leading-zeros" suffix="."/>&lt;date-part name="year"/>&lt;/date>&lt;terms>&lt;term name="accessed">zugegriffen&lt;/term>&lt;term name="and">und&lt;/term>&lt;term name="and others">und andere&lt;/term>&lt;term name="anonymous">ohne Autor&lt;/term>&lt;term name="anonymous" form="short">o.&amp;#160;A.&lt;/term>&lt;term name="at">auf&lt;/term>&lt;term name="available at">verfgbar unter&lt;/term>&lt;term name="by">von&lt;/term>&lt;term name="circa">circa&lt;/term>&lt;term name="circa" form="short">ca.&lt;/term>&lt;term name="cited">zitiert&lt;/term>&lt;term name="edition">&lt;single>Auflage&lt;/single>&lt;multiple>Auflagen&lt;/multiple>&lt;/term>&lt;term name="edition" form="short">Aufl.&lt;/term>&lt;term name="et-al">u.&amp;#160;a.&lt;/term>&lt;term name="forthcoming">i.&amp;#160;E.&lt;/term>&lt;term name="from">von&lt;/term>&lt;term name="ibid">ebd.&lt;/term>&lt;term name="in">in&lt;/term>&lt;term name="in press">im Druck&lt;/term>&lt;term name="internet">Internet&lt;/term>&lt;term name="interview">Interview&lt;/term>&lt;term name="letter">Brief&lt;/term>&lt;term name="no date">ohne Datum&lt;/term>&lt;term name="no date" form="short">o.&amp;#160;J.&lt;/term>&lt;term name="online">online&lt;/term>&lt;term name="presented at">gehalten auf der&lt;/term>&lt;term name="reference">&lt;single>Referenz&lt;/single>&lt;multiple>Referenzen&lt;/multiple>&lt;/term>&lt;term name="reference" form="short">&lt;single>Ref.&lt;/single>&lt;multiple>Ref.&lt;/multiple>&lt;/term>&lt;term name="retrieved">abgerufen&lt;/term>&lt;term name="scale">Mastab&lt;/term>&lt;term name="version">Version&lt;/term>&lt;term name="ad">n.&amp;#160;Chr.&lt;/term>&lt;term name="bc">v.&amp;#160;Chr.&lt;/term>&lt;term name="open-quote">&lt;/term>&lt;term name="close-quote">&lt;/term>&lt;term name="open-inner-quote">&lt;/term>&lt;term name="close-inner-quote">&lt;/term>&lt;term name="page-range-delimiter">&lt;/term>&lt;term name="ordinal">.&lt;/term>&lt;term name="long-ordinal-01">erster&lt;/term>&lt;term name="long-ordinal-02">zweiter&lt;/term>&lt;term name="long-ordinal-03">dritter&lt;/term>&lt;term name="long-ordinal-04">vierter&lt;/term>&lt;term name="long-ordinal-05">fnfter&lt;/term>&lt;term name="long-ordinal-06">sechster&lt;/term>&lt;term name="long-ordinal-07">siebter&lt;/term>&lt;term name="long-ordinal-08">achter&lt;/term>&lt;term name="long-ordinal-09">neunter&lt;/term>&lt;term name="long-ordinal-10">zehnter&lt;/term>&lt;term name="book">&lt;single>Buch&lt;/single>&lt;multiple>Bcher&lt;/multiple>&lt;/term>&lt;term name="chapter">&lt;single>Kapitel&lt;/single>&lt;multiple>Kapitel&lt;/multiple>&lt;/term>&lt;term name="column">&lt;single>Spalte&lt;/single>&lt;multiple>Spalten&lt;/multiple>&lt;/term>&lt;term name="figure">&lt;single>Abbildung&lt;/single>&lt;multiple>Abbildungen&lt;/multiple>&lt;/term>&lt;term name="folio">&lt;single>Blatt&lt;/single>&lt;multiple>Bltter&lt;/multiple>&lt;/term>&lt;term name="issue">&lt;single>Nummer&lt;/single>&lt;multiple>Nummern&lt;/multiple>&lt;/term>&lt;term name="line">&lt;single>Zeile&lt;/single>&lt;multiple>Zeilen&lt;/multiple>&lt;/term>&lt;term name="note">&lt;single>Note&lt;/single>&lt;multiple>Noten&lt;/multiple>&lt;/term>&lt;term name="opus">&lt;single>Opus&lt;/single>&lt;multiple>Opera&lt;/multiple>&lt;/term>&lt;term name="page">&lt;single>Seite&lt;/single>&lt;multiple>Seiten&lt;/multiple>&lt;/term>&lt;term name="number-of-pages">&lt;single>Seite&lt;/single>&lt;multiple>Seiten&lt;/multiple>&lt;/term>&lt;term name="paragraph">&lt;single>Absatz&lt;/single>&lt;multiple>Abstze&lt;/multiple>&lt;/term>&lt;term name="part">&lt;single>Teil&lt;/single>&lt;multiple>Teile&lt;/multiple>&lt;/term>&lt;term name="section">&lt;single>Abschnitt&lt;/single>&lt;multiple>Abschnitte&lt;/multiple>&lt;/term>&lt;term name="sub verbo">&lt;single>sub verbo&lt;/single>&lt;multiple>sub verbis&lt;/multiple>&lt;/term>&lt;term name="verse">&lt;single>Vers&lt;/single>&lt;multiple>Verse&lt;/multiple>&lt;/term>&lt;term name="volume">&lt;single>Band&lt;/single>&lt;multiple>Bnde&lt;/multiple>&lt;/term>&lt;term name="book" form="short">B.&lt;/term>'+
'&lt;term name="chapter" form="short">Kap.&lt;/term>&lt;term name="column" form="short">Sp.&lt;/term>&lt;term name="figure" form="short">Abb.&lt;/term>&lt;term name="folio" form="short">Fol.&lt;/term>&lt;term name="issue" form="short">Nr.&lt;/term>&lt;term name="line" form="short">Z.&lt;/term>&lt;term name="note" form="short">N.&lt;/term>&lt;term name="opus" form="short">op.&lt;/term>&lt;term name="page" form="short">&lt;single>S.&lt;/single>&lt;multiple>S.&lt;/multiple>&lt;/term>&lt;term name="number-of-pages" form="short">&lt;single>S.&lt;/single>&lt;multiple>S.&lt;/multiple>&lt;/term>&lt;term name="paragraph" form="short">Abs.&lt;/term>&lt;term name="part" form="short">Teil&lt;/term>&lt;term name="section" form="short">Abschn.&lt;/term>&lt;term name="sub verbo" form="short">&lt;single>s.&amp;#160;v.&lt;/single>&lt;multiple>s.&amp;#160;vv.&lt;/multiple>&lt;/term>&lt;term name="verse" form="short">&lt;single>V.&lt;/single>&lt;multiple>V.&lt;/multiple>&lt;/term>&lt;term name="volume" form="short">&lt;single>Bd.&lt;/single>&lt;multiple>Bde.&lt;/multiple>&lt;/term>&lt;term name="paragraph" form="symbol">&lt;single>&lt;/single>&lt;multiple>&lt;/multiple>&lt;/term>&lt;term name="section" form="symbol">&lt;single>&lt;/single>&lt;multiple>&lt;/multiple>&lt;/term>&lt;term name="director">&lt;single>Regisseur&lt;/single>&lt;multiple>Regisseure&lt;/multiple>&lt;/term>&lt;term name="editor">&lt;single>Herausgeber&lt;/single>&lt;multiple>Herausgeber&lt;/multiple>&lt;/term>&lt;term name="collection-editor">&lt;single>Reihenherausgeber&lt;/single>&lt;multiple>Reihenherausgeber&lt;/multiple>&lt;/term>&lt;term name="editorial-director">&lt;single>Herausgeber&lt;/single>&lt;multiple>Herausgeber&lt;/multiple>&lt;/term>&lt;term name="illustrator">&lt;single>Illustrator&lt;/single>&lt;multiple>Illustratoren&lt;/multiple>&lt;/term>&lt;term name="translator">&lt;single>bersetzer&lt;/single>&lt;multiple>bersetzer&lt;/multiple>&lt;/term>&lt;term name="editortranslator">&lt;single>Herausgeber&amp;#160;&amp;amp; bersetzer&lt;/single>&lt;multiple>Herausgeber&amp;#160;&amp;amp; bersetzer&lt;/multiple>&lt;/term>&lt;term name="director" form="short">&lt;single>Reg.&lt;/single>&lt;multiple>Reg.&lt;/multiple>&lt;/term>&lt;term name="editor" form="short">&lt;single>Hrsg.&lt;/single>&lt;multiple>Hrsg.&lt;/multiple>&lt;/term>&lt;term name="collection-editor" form="short">&lt;single>Hrsg.&lt;/single>&lt;multiple>Hrsg.&lt;/multiple>&lt;/term>&lt;term name="editorial-director" form="short">&lt;single>Hrsg.&lt;/single>&lt;multiple>Hrsg.&lt;/multiple>&lt;/term>&lt;term name="illustrator" form="short">&lt;single>Ill.&lt;/single>&lt;multiple>Ill.&lt;/multiple>&lt;/term>&lt;term name="translator" form="short">&lt;single>bers.&lt;/single>&lt;multiple>bers.&lt;/multiple>&lt;/term>&lt;term name="editortranslator" form="short">&lt;single>Hrsg.&amp;#160;&amp;amp; bers.&lt;/single>&lt;multiple>Hrsg.&amp;#160;&amp;amp; bers&lt;/multiple>&lt;/term>&lt;term name="container-author" form="verb">von&lt;/term>&lt;term name="director" form="verb">Regie von&lt;/term>&lt;term name="editor" form="verb">herausgegeben von&lt;/term>&lt;term name="collection-editor" form="verb">herausgegeben von&lt;/term>&lt;term name="editorial-director" form="verb">herausgegeben von&lt;/term>&lt;term name="illustrator" form="verb">illustriert von&lt;/term>&lt;term name="interviewer" form="verb">interviewt von&lt;/term>&lt;term name="recipient" form="verb">an&lt;/term>&lt;term name="reviewed-author" form="verb">von&lt;/term>&lt;term name="translator" form="verb">bersetzt von&lt;/term>&lt;term name="editortranslator" form="verb">herausgegeben und bersetzt von&lt;/term>&lt;term name="director" form="verb-short">Reg.&lt;/term>&lt;term name="editor" form="verb-short">hg. von&lt;/term>&lt;term name="collection-editor" form="verb-short">hg. von&lt;/term>&lt;term name="editorial-director" form="verb-short">hg. von&lt;/term>&lt;term name="illustrator" form="verb-short">illus. von&lt;/term>&lt;term name="translator" form="verb-short">bers. von&lt;/term>&lt;term name="editortranslator" form="verb-short">hg.&amp;#160;&amp;amp; bers. von&lt;/term>&lt;term name="month-01">Januar&lt;/term>&lt;term name="month-02">Februar&lt;/term>&lt;term name="month-03">Mrz&lt;/term>&lt;term name="month-04">April&lt;/term>&lt;term name="month-05">Mai&lt;/term>&lt;term name="month-06">Juni&lt;/term>&lt;term name="month-07">Juli&lt;/term>&lt;term name="month-08">August&lt;/term>&lt;term name="month-09">September&lt;/term>&lt;term name="month-10">Oktober&lt;/term>&lt;term name="month-11">November&lt;/term>&lt;term name="month-12">Dezember&lt;/term>&lt;term name="month-01" form="short">Jan.&lt;/term>&lt;term name="month-02" form="short">Feb.&lt;/term>'+
'&lt;term name="month-03" form="short">Mrz&lt;/term>&lt;term name="month-04" form="short">Apr.&lt;/term>&lt;term name="month-05" form="short">Mai&lt;/term>&lt;term name="month-06" form="short">Juni&lt;/term>&lt;term name="month-07" form="short">Juli&lt;/term>&lt;term name="month-08" form="short">Aug.&lt;/term>&lt;term name="month-09" form="short">Sep.&lt;/term>&lt;term name="month-10" form="short">Okt.&lt;/term>&lt;term name="month-11" form="short">Nov.&lt;/term>&lt;term name="month-12" form="short">Dez.&lt;/term>&lt;term name="season-01">Frhjahr&lt;/term>&lt;term name="season-02">Sommer&lt;/term>&lt;term name="season-03">Herbst&lt;/term>&lt;term name="season-04">Winter&lt;/term>&lt;/terms>&lt;/locale>'
, 'es-ES': '&lt;?xml version="1.0" encoding="utf-8"?>&lt;locale xmlns="http://purl.org/net/xbiblio/csl" version="1.0" xml:lang="es-ES">&lt;info>&lt;rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License&lt;/rights>&lt;updated>2012-07-04T23:31:02+00:00&lt;/updated>&lt;/info>&lt;style-options punctuation-in-quote="false"/>&lt;date form="text">&lt;date-part name="day" suffix=" de "/>&lt;date-part name="month" suffix=" de "/>&lt;date-part name="year"/>&lt;/date>&lt;date form="numeric">&lt;date-part name="day" form="numeric-leading-zeros" suffix="/"/>&lt;date-part name="month" form="numeric-leading-zeros" suffix="/"/>&lt;date-part name="year"/>&lt;/date>&lt;terms>&lt;term name="accessed">accedido&lt;/term>&lt;term name="and">y&lt;/term>&lt;term name="and others">y otros&lt;/term>&lt;term name="anonymous">annimo&lt;/term>&lt;term name="anonymous" form="short">ann.&lt;/term>&lt;term name="at">en&lt;/term>&lt;term name="available at">disponible en&lt;/term>&lt;term name="by">de&lt;/term>&lt;term name="circa">circa&lt;/term>&lt;term name="circa" form="short">c.&lt;/term>&lt;term name="cited">citado&lt;/term>&lt;term name="edition">&lt;single>edicin&lt;/single>&lt;multiple>ediciones&lt;/multiple>&lt;/term>&lt;term name="edition" form="short">ed.&lt;/term>&lt;term name="et-al">et&amp;#160;al.&lt;/term>&lt;term name="forthcoming">previsto&lt;/term>&lt;term name="from">a partir de&lt;/term>&lt;term name="ibid">ibid.&lt;/term>&lt;term name="in">en&lt;/term>&lt;term name="in press">en imprenta&lt;/term>&lt;term name="internet">internet&lt;/term>&lt;term name="interview">entrevista&lt;/term>&lt;term name="letter">carta&lt;/term>&lt;term name="no date">sin fecha&lt;/term>&lt;term name="no date" form="short">s.&amp;#160;f.&lt;/term>&lt;term name="online">en lnea&lt;/term>&lt;term name="presented at">presentado en&lt;/term>&lt;term name="reference">&lt;single>referencia&lt;/single>&lt;multiple>referencias&lt;/multiple>&lt;/term>&lt;term name="reference" form="short">&lt;single>ref.&lt;/single>&lt;multiple>refs.&lt;/multiple>&lt;/term>&lt;term name="retrieved">recuperado&lt;/term>&lt;term name="scale">escala&lt;/term>&lt;term name="version">versin&lt;/term>&lt;term name="ad">d.&amp;#160;C.&lt;/term>&lt;term name="bc">a.&amp;#160;C.&lt;/term>&lt;term name="open-quote">&lt;/term>&lt;term name="close-quote">&lt;/term>&lt;term name="open-inner-quote">&lt;/term>&lt;term name="close-inner-quote">&lt;/term>&lt;term name="page-range-delimiter">-&lt;/term>&lt;term name="ordinal">.&lt;/term>&lt;term name="long-ordinal-01">primera&lt;/term>&lt;term name="long-ordinal-02">segunda&lt;/term>&lt;term name="long-ordinal-03">tercera&lt;/term>&lt;term name="long-ordinal-04">cuarta&lt;/term>&lt;term name="long-ordinal-05">quinta&lt;/term>&lt;term name="long-ordinal-06">sexta&lt;/term>&lt;term name="long-ordinal-07">sptima&lt;/term>&lt;term name="long-ordinal-08">octava&lt;/term>&lt;term name="long-ordinal-09">novena&lt;/term>&lt;term name="long-ordinal-10">dcima&lt;/term>&lt;term name="book">&lt;single>libro&lt;/single>&lt;multiple>libros&lt;/multiple>&lt;/term>&lt;term name="chapter">&lt;single>captulo&lt;/single>&lt;multiple>captulos&lt;/multiple>&lt;/term>&lt;term name="column">&lt;single>columna&lt;/single>&lt;multiple>columnas&lt;/multiple>&lt;/term>&lt;term name="figure">&lt;single>figura&lt;/single>&lt;multiple>figuras&lt;/multiple>&lt;/term>&lt;term name="folio">&lt;single>folio&lt;/single>&lt;multiple>folios&lt;/multiple>&lt;/term>&lt;term name="issue">&lt;single>nmero&lt;/single>&lt;multiple>nmeros&lt;/multiple>&lt;/term>&lt;term name="line">&lt;single>lnea&lt;/single>&lt;multiple>lneas&lt;/multiple>&lt;/term>&lt;term name="note">&lt;single>nota&lt;/single>&lt;multiple>notas&lt;/multiple>&lt;/term>&lt;term name="opus">&lt;single>opus&lt;/single>&lt;multiple>opera&lt;/multiple>&lt;/term>&lt;term name="page">&lt;single>pgina&lt;/single>&lt;multiple>pginas&lt;/multiple>&lt;/term>&lt;term name="number-of-pages">&lt;single>pgina&lt;/single>&lt;multiple>pginas&lt;/multiple>&lt;/term>&lt;term name="paragraph">&lt;single>prrafo&lt;/single>&lt;multiple>prrafos&lt;/multiple>&lt;/term>&lt;term name="part">&lt;single>parte&lt;/single>&lt;multiple>partes&lt;/multiple>&lt;/term>&lt;term name="section">&lt;single>seccin&lt;/single>&lt;multiple>secciones&lt;/multiple>&lt;/term>&lt;term name="sub verbo">&lt;single>sub voce&lt;/single>&lt;multiple>sub vocibus&lt;/multiple>&lt;/term>&lt;term name="verse">&lt;single>verso&lt;/single>&lt;multiple>versos&lt;/multiple>&lt;/term>&lt;term name="volume">&lt;single>volumen&lt;/single>&lt;multiple>volmenes&lt;/multiple>&lt;/term>&lt;term name="book" form="short">lib.&lt;/term>'+
'&lt;term name="chapter" form="short">cap.&lt;/term>&lt;term name="column" form="short">col.&lt;/term>&lt;term name="figure" form="short">fig.&lt;/term>&lt;term name="folio" form="short">f.&lt;/term>&lt;term name="issue" form="short">n.&lt;/term>&lt;term name="line" form="short">l.&lt;/term>&lt;term name="note" form="short">n.&lt;/term>&lt;term name="opus" form="short">op.&lt;/term>&lt;term name="page" form="short">&lt;single>p.&lt;/single>&lt;multiple>pp.&lt;/multiple>&lt;/term>&lt;term name="number-of-pages" form="short">&lt;single>p.&lt;/single>&lt;multiple>pp.&lt;/multiple>&lt;/term>&lt;term name="paragraph" form="short">prr.&lt;/term>&lt;term name="part" form="short">pt.&lt;/term>&lt;term name="section" form="short">sec.&lt;/term>&lt;term name="sub verbo" form="short">&lt;single>s.&amp;#160;v.&lt;/single>&lt;multiple>s.&amp;#160;vv.&lt;/multiple>&lt;/term>&lt;term name="verse" form="short">&lt;single>v.&lt;/single>&lt;multiple>vv.&lt;/multiple>&lt;/term>&lt;term name="volume" form="short">&lt;single>vol.&lt;/single>&lt;multiple>vols.&lt;/multiple>&lt;/term>&lt;term name="paragraph" form="symbol">&lt;single>&lt;/single>&lt;multiple>&lt;/multiple>&lt;/term>&lt;term name="section" form="symbol">&lt;single>&lt;/single>&lt;multiple>&lt;/multiple>&lt;/term>&lt;term name="director">&lt;single>director&lt;/single>&lt;multiple>directores&lt;/multiple>&lt;/term>&lt;term name="editor">&lt;single>editor&lt;/single>&lt;multiple>editores&lt;/multiple>&lt;/term>&lt;term name="editorial-director">&lt;single>editor&lt;/single>&lt;multiple>editores&lt;/multiple>&lt;/term>&lt;term name="illustrator">&lt;single>ilustrador&lt;/single>&lt;multiple>ilustradores&lt;/multiple>&lt;/term>&lt;term name="translator">&lt;single>traductor&lt;/single>&lt;multiple>traductores&lt;/multiple>&lt;/term>&lt;term name="editortranslator">&lt;single>editor y traductor&lt;/single>&lt;multiple>editores y traductores&lt;/multiple>&lt;/term>&lt;term name="director" form="short">&lt;single>dir.&lt;/single>&lt;multiple>dirs.&lt;/multiple>&lt;/term>&lt;term name="editor" form="short">&lt;single>ed.&lt;/single>&lt;multiple>eds.&lt;/multiple>&lt;/term>&lt;term name="editorial-director" form="short">&lt;single>ed.&lt;/single>&lt;multiple>eds.&lt;/multiple>&lt;/term>&lt;term name="illustrator" form="short">&lt;single>ilust.&lt;/single>&lt;multiple>ilusts.&lt;/multiple>&lt;/term>&lt;term name="translator" form="short">&lt;single>trad.&lt;/single>&lt;multiple>trads.&lt;/multiple>&lt;/term>&lt;term name="editortranslator" form="short">&lt;single>ed. y trad.&lt;/single>&lt;multiple>eds. y trads.&lt;/multiple>&lt;/term>&lt;term name="container-author" form="verb">de&lt;/term>&lt;term name="director" form="verb">dirigido por&lt;/term>&lt;term name="editor" form="verb">editado por&lt;/term>&lt;term name="editorial-director" form="verb">editado por&lt;/term>&lt;term name="illustrator" form="verb">ilustrado por&lt;/term>&lt;term name="interviewer" form="verb">entrevistado por&lt;/term>&lt;term name="recipient" form="verb">a&lt;/term>&lt;term name="reviewed-author" form="verb">por&lt;/term>&lt;term name="translator" form="verb">traducido por&lt;/term>&lt;term name="editortranslator" form="verb">editado y traducido por&lt;/term>&lt;term name="director" form="verb-short">dir.&lt;/term>&lt;term name="editor" form="verb-short">ed.&lt;/term>&lt;term name="editorial-director" form="verb-short">ed.&lt;/term>&lt;term name="illustrator" form="verb-short">ilust.&lt;/term>&lt;term name="translator" form="verb-short">trad.&lt;/term>&lt;term name="editortranslator" form="verb-short">ed. y trad.&lt;/term>&lt;term name="month-01">enero&lt;/term>&lt;term name="month-02">febrero&lt;/term>&lt;term name="month-03">marzo&lt;/term>&lt;term name="month-04">abril&lt;/term>&lt;term name="month-05">mayo&lt;/term>&lt;term name="month-06">junio&lt;/term>&lt;term name="month-07">julio&lt;/term>&lt;term name="month-08">agosto&lt;/term>&lt;term name="month-09">septiembre&lt;/term>&lt;term name="month-10">octubre&lt;/term>&lt;term name="month-11">noviembre&lt;/term>&lt;term name="month-12">diciembre&lt;/term>&lt;term name="month-01" form="short">ene.&lt;/term>&lt;term name="month-02" form="short">feb.&lt;/term>&lt;term name="month-03" form="short">mar.&lt;/term>&lt;term name="month-04" form="short">abr.&lt;/term>&lt;term name="month-05" form="short">may&lt;/term>&lt;term name="month-06" form="short">jun.&lt;/term>&lt;term name="month-07" form="short">jul.&lt;/term>&lt;term name="month-08" form="short">ago.&lt;/term>&lt;term name="month-09" form="short">sep.&lt;/term>&lt;term name="month-10" form="short">oct.&lt;/term>&lt;term name="month-11" form="short">nov.&lt;/term>&lt;term name="month-12" form="short">'+
'dic.&lt;/term>&lt;term name="season-01">primavera&lt;/term>&lt;term name="season-02">verano&lt;/term>&lt;term name="season-03">otoo&lt;/term>&lt;term name="season-04">invierno&lt;/term>&lt;/terms>&lt;/locale>'
}

/**
 * Object containing CSL Engines
 * 
 * @access private
 * @constant varCSLEngines
 * @default
 */
var varCSLEngines = {}

/**
 * Object containing HTML strings for building JSON and BibTeX. Made to match citeproc, for compatability.
 * 
 * @access private
 * @constant varHTMLDict
 * @default
 */
var varHTMLDict = {
  wr_start : '&lt;div class="csl-bib-body">'
, wr_end   : '&lt;/div>'
, en_start : '&lt;div class="csl-entry">'
, en_end   : '&lt;/div>'
, ul_start : '&lt;ul style="list-style-type:none">'
, ul_end   : '&lt;/ul>'
, li_start : '&lt;li>'
, li_end   : '&lt;/li>'
}

/**
 * Convert a CSL date into human-readable format
 * 
 * @access private
 * @function getDate
 * 
 * @param {String[]} date - A date in CSL format
 * 
 * @return {String} The string
 */
var getDate = function ( date ) {
  var res  = ''
    , date = date[ 0 ][ 'date-parts' ]
  
  if ( date.length === 3 )
    res += [
      ('000'+ date[ 0 ] ).slice( -4 )
    , ( '0' + date[ 1 ] ).slice( -2 )
    , ( '0' + date[ 2 ] ).slice( -2 )
    ].join( '-' )
  
  return res
}

/**
 * Convert epoch to CSL date
 * 
 * @access private
 * @function parseDate
 * 
 * @param {Number|String} value - Epoch time or string in format "YYYY-MM-DD"
 * 
 * @return {Object[]} Array of an object, containing the property "date-parts" with the value [ YYYY, MM, DD ]
 */
var parseDate = function ( value ) {
  var rValue
    , date = new Date( value )
  
  rValue = [
    date.getFullYear()
  , date.getMonth   () + 1
  , date.getDate    ()
  ]
  
  return [ { 'date-parts': rValue } ]
}

/**
 * Get name from CSL
 * 
 * @access private
 * @method getName
 * 
 * @param {Object} obj - CSL input
 * 
 * @return {String} Full name
 */
var getName = function ( obj ) {
  var arr = [ 'dropping-particle', 'given', 'suffix', 'non-dropping-particle', 'family' ]
    , res = ''
  
  for ( var i = 0; i &lt; arr.length; i++ ) {
    if ( obj.hasOwnProperty( arr[ i ] ) )
      res += obj[ arr[ i ] ] + ' '
  }
  
  if ( res.length )
    res = res.slice( 0, -1 )
  else if ( res.hasOwnProperty( 'literal' ) )
    res = obj.literal
  
  return res
}

/**
 * Get CSL from name
 * 
 * @access private
 * @method parseName
 * 
 * @param {String} str - string 
 * 
 * @return {Object} The CSL object
 */
var parseName = function ( str ) {
  
  if ( str.indexOf( ', ' ) > -1 )
    var arr = str.split( ', ' ).reverse()
  else
    var arr = str.split( varRegex.name )
  
  var obj = {
    given : arr[ 0 ]
  , family: arr[ 1 ]
  }
  
  return obj
}

/**
 * Add data-* attribute to a HTML string
 * 
 * @access private
 * @method getAttributedEntry
 * 
 * @param {String} string - HTML string
 * @param {String} name - attribute name
 * @param {String} value - attribute value
 * 
 * @return {String} HTML string with attribute
 */
var getAttributedEntry = function ( string, name, value ) {
  return string.replace( /^\s*&lt;[a-z]+/, function ( match ) {
    return `${match} data-${name}="${value}"`
  } )
}

/**
 * Add CSL identifiers to entry
 * 
 * @access private
 * @method getPrefixedEntry
 * 
 * @param {String} value - HTML string
 * @param {Number} index - ID index
 * @param {String[]} list - ID list
 * 
 * @return {String} HTML string with CSL ID
 */
var getPrefixedEntry = function ( value, index, list ) {
  var id = list[ index ]
  return getAttributedEntry( value, 'csl-entry-id', id )
}

/**
 * Generate ID
 * 
 * @access private
 * @method fetchId
 * 
 * @param {String[]} list - old ID list
 * @param {Number} index - current ID index
 * @param {String} prefix - ID prefix
 * 
 * @return {String} CSL ID
 */
var fetchId = function ( list, index, prefix ) {
  var arr = list.slice()
    , id  = arr[ index ]
    , del = ','
  
  while ( true ) {
    arr[ index ] = id = prefix + Math.random().toString().slice( 2 )
    
    if (
      typeof id === 'string' &amp;&amp;
      ( arr.join( del ).match( `(?:^|${del})${id}(?:$|${del})` ) || [] ).length === 1
    ) break
  }
  
  return id
}

/**
 * CSL pub type to BibTeX pub type
 * 
 * @access private
 * @method fetchBibTeXType
 * 
 * @param {String} pubType - CSL type
 * 
 * @return {String} BibTeX type
 */
var fetchBibTeXType = function ( pubType ) {
  
  switch ( pubType ) {
    case 'article':
    case 'article-journal':
    case 'article-magazine':
    case 'article-newspaper':
      return 'article';
      break;
    
    case 'book':
      return 'book';
      break;
    
    case 'chapter':
      return 'incollection';
      break;
    
    case 'manuscript':
      return 'unpublished';
      break;
    
    case 'paper-conference':
      return 'inproceedings';
      break;
    
    case 'patent':
      return 'patent';
      break;
    
    case 'report':
      return 'techreport';
      break;
    
    case 'thesis':
      return 'phdthesis'
      break;
    
    case 'graphic':
    case 'interview':
    case 'motion_picture':
    case 'personal_communication':
    case 'webpage':
      return 'misc';
      break;
    
    default:
      console.warn( 'CSL publication type not recognized: ' + pubType + '. Interpreting as "misc".' )
      return 'misc';
      break;
  }
}

/**
 * BibTeX pub type to CSL pub type
 * 
 * @access private
 * @method parseBibTeXType
 * 
 * @param {String} pubType - BibTeX type
 * 
 * @return {String} CSL type
 */
var parseBibTeXType = function ( pubType ) {
  switch ( pubType ) {
    
    case 'article':
      return 'article-journal';
      break;
    
    case 'book':
    case 'booklet':
    case 'manual':
    case 'misc':
    case 'proceedings':
      return 'book';
      break;
    
    case 'inbook':
    case 'incollection':
      return 'chapter';
      break;
    
    case 'conference':
    case 'inproceedings':
      return 'paper-conference';
      break;
    
    case 'online':
      return 'webpage'
      break;
    
    case 'patent':
      return 'patent';
      break;
    
    case 'phdthesis':
    case 'mastersthesis':
      return 'thesis';
      break;
    
    case 'techreport':
      return 'report';
      break;
    
    case 'unpublished':
      return 'manuscript';
      break;
    
    default:
      console.warn( 'BibTeX publication type not recognized: ' + pubType + '. Interpreting as "book".' )
      return 'book';
      break;
  }
}

/**
 * Get a BibTeX label from CSL data
 * 
 * @access private
 * @method getBibTeXLabel
 * 
 * @param {CSL} src - Input CSL
 * 
 * @return {String} The label
 */
var getBibTeXLabel = function ( src ) {
  var res = ''
  
  if ( src.hasOwnProperty( 'author' ) &amp;&amp; Array.isArray( src.author ) &amp;&amp; src.author.length > 0 )
    res += src.author[ 0 ].family || src.author[ 0 ].literal
  
  if ( src.hasOwnProperty( 'year' ) )
    res += src.year
  else if ( src.issued &amp;&amp; src.issued[ 0 ] &amp;&amp; src.issued[ 0 ][ 'date-parts' ] )
    res += src.issued[ 0 ][ 'date-parts' ][ 0 ]
  
  if ( src.hasOwnProperty( 'title' ) )
    res += src.title.replace(/^(the|a|an) /i,'').split(' ')[ 0 ]
  
  return res
}

/**
 * Get BibTeX-JSON from CSL(-JSON)
 * 
 * @access private
 * @method getBibTeXJSON
 * 
 * @param {CSL} src - Input CSL
 * 
 * @return {Object} Output BibTeX-JSON
 */
var getBibTeXJSON = function ( src ) {
  var src = JSON.parse( JSON.stringify( src ) )
    , res = {}
    , props = {}
  
  res.label = src.label || getBibTeXLabel( src )
  res.type  = fetchBibTeXType( src.type )
  
  if ( src.hasOwnProperty( 'author'    ) ) props.author    = src.author.slice().map( getName ).join( ' and ' )
  if ( src.hasOwnProperty( 'event'     ) ) props.organization = src.event
  if ( src.hasOwnProperty( 'accessed'  ) ) props.note      = '[Online; accesed ' + getDate( src.accessed ) + ']'
  if ( src.hasOwnProperty( 'DOI'       ) ) props.doi       = src.DOI
  if ( src.hasOwnProperty( 'editor'    ) ) props.editor    = src.editor.slice().map( getName ).join( ' and ' )
  if ( src.hasOwnProperty( 'ISBN'      ) ) props.isbn      = src.ISBN
  if ( src.hasOwnProperty( 'ISSN'      ) ) props.issn      = src.ISSN
  if ( src.hasOwnProperty( 'container-title' ) ) props.journal = src[ 'container-title' ]
  if ( src.hasOwnProperty( 'issue'     ) ) props.issue     = src.issue.toString()
  if ( src.hasOwnProperty( 'page'      ) ) props.pages     = src.page.replace( '-', '--' )
  if ( src.hasOwnProperty( 'publisher-place' ) ) props.address = src[ 'publisher-place' ]
  if ( src.hasOwnProperty( 'edition'   ) ) props.edition   = src.edition.toString()
  if ( src.hasOwnProperty( 'publisher' ) ) props.publisher = src.publisher
  if ( src.hasOwnProperty( 'title'     ) ) props.title     = src[ 'title' ]
  if ( src.hasOwnProperty( 'url'       ) ) props.url       = src.url
  if ( src.hasOwnProperty( 'volume'    ) ) props.volume    = src.volume.toString()
  if ( src.hasOwnProperty( 'issued'    )
    &amp;&amp; Array.isArray( src.issued )
    &amp;&amp; src.issued[ 0 ][ 'date-parts' ].length === 3
                                         ) props.year      = src.issued[ 0 ][ 'date-parts' ][ 0 ].toString()
  
  res.properties = props
  
  return res
}

/**
 * Get a BibTeX (HTML) string from CSL
 * 
 * @access private
 * @method getBibTeX
 * 
 * @param {CSL[]} src - Input CSL
 * @param {Boolean} html - Output as HTML string (instead of plain text)
 * 
 * @return {String} BibTeX (HTML) string
 */
var getBibTeX = function ( src, html ) {
  var res = ''
    , dict= varHTMLDict
  
  if ( html )
    res += dict.wr_start
  
  for ( var i = 0; i &lt; src.length; i++ ) {
    var entry = src[ i ]
      , bib   = getBibTeXJSON( entry )
    
    if ( html )
      res += dict.en_start
    
    res += '@' + bib.type + '{' + bib.label + ','
    
    if ( html )
      res += dict.ul_start,
      res += dict.li_start
    else
      res += '\n'
    
    var props = Object.keys( bib.properties )
    
    for ( var propIndex = 0; propIndex &lt; props.length; propIndex++ ) {
      var prop = props[ propIndex ]
        , value= bib.properties[ prop ].replace( /[|&lt;>~^\\{}]/g, function ( match ) {
            return varBibTeXSyntaxTokens[ match ]
          } )
        , del_start=
        
          // Number
          value == parseInt( value ).toString() ? '' :
          // Title or other capital-related fields
          prop === 'title' ? '{{' :
          // Default
          '{'
          
        , del_end= del_start.replace( /{/g, '}' ).split( '' ).reverse().join( '' )
      
      if ( !html )
        res += '\t'
      
      res += prop + '=' + del_start + value + del_end + ','
      
      if ( propIndex + 1 &lt; props.length ) {
      
        if ( html )
          res += dict.li_end,
          res += dict.li_start
        
      }
      
      if ( !html )
        res += '\n'
    }
    
    if ( html )
      res += dict.li_end,
      res += dict.ul_end
    
    res += '}'
    
    if ( html )
      res += dict.en_end
  }
  
  if ( html )
    res += dict.wr_end
  else
    res += '\n'
  
  return res
}

/**
 * Get a label from CSL data
 * 
 * @access private
 * @method getLabel
 * 
 * @param {CSL} src - Input CSL
 * 
 * @return {String} The label
 */
var getLabel = function ( src ) {
  return getBibTeXLabel( src )
}

/**
 * Retrieve CSL locale
 * 
 * @access private
 * @method fetchCSLLocale
 * 
 * @param {String} lang - lang code
 * 
 * @return {String} CSL locale
 */
var fetchCSLLocale = function ( lang ) {
  return varCSLLocales[ lang ]
}

/**
 * Retrieve CSL style
 * 
 * @access private
 * @method fetchCSLStyle
 * 
 * @param {String} [style="apa"] - style name
 * 
 * @return {String} CSL style
 */
var fetchCSLStyle = function ( style ) {
  return varCSLStyles.hasOwnProperty( style || '' ) ? varCSLStyles[ style ] : varCSLStyles[ 'apa' ]
}

/**
 * @callback Cite~retrieveItem
 * @param {String} id - Citation id
 * @return {CSL} CSL Citation object
 */

/**
 * @callback Cite~retrieveLocale
 * @param {String} lang - Language code
 * @return {String} CSL Locale
 */

/**
 * Retrieve CSL parsing engine
 * 
 * @access private
 * @method fetchCSLEngine
 * 
 * @param {String} style - CSL style id
 * @param {String} lang - Language code
 * @param {String} template - CSL XML template
 * @param {Cite~retrieveItem} retrieveItem - Code to retreive item
 * @param {Cite~retrieveLocale} retrieveLocale - Code to retreive locale
 * 
 * @return {Object} CSL Engine
 */
var fetchCSLEngine = function ( style, lang, template, retrieveItem, retrieveLocale ) {
  var prop = style + '|' + lang
    , engine
  
  if ( varCSLEngines.hasOwnProperty( prop ) )
    engine = varCSLEngines[ prop ],
    engine.sys.retrieveItem = retrieveItem
  else
    engine = varCSLEngines[ prop ] = new CSL.Engine( { retrieveLocale: retrieveLocale, retrieveItem: retrieveItem }, template, lang, true )
  
  return engine
}

/**
 * Retrieve CSL item callback function
 * 
 * @access private
 * @method fetchCSLItemCallback
 * 
 * @param {CSL[]} data - CSL array
 * 
 * @return {Cite~retrieveItem} Code to retreive item
 */
var fetchCSLItemCallback = function ( data ) {
  var _data = data
  var fetchCSLItem = function ( id ) {
    var res
    
    for ( var entryIndex = 0; entryIndex &lt; _data.length; entryIndex++ ) {
      var entry = _data[ entryIndex ]
      
      if ( entry.id === id )
        res = entry
    }
    
    if ( !res &amp;&amp; parseInt( id ) + 1 )
      res = _data[ id ]
    
    return res
  }
  return fetchCSLItem
}


/**
 * Fetch file
 * 
 * @access private
 * @method fetchFile
 * 
 * @param {String} url - The input url
 * 
 * @return {String} The fetched string
 */
var fetchFile = function ( url ) {
  var result
    , url = typeof encodeURI === 'function' ? encodeURI( url ) : url
  
  try {
    result  = request( 'GET', url ).getBody( 'utf8' )
  } catch (e) {
    return console.error( '[set]', 'File could not be fetched' )
  }
  
  if ( result === url )
    return console.error( '[set]', 'Infinite chaining loop detected' )
  
  else
    return result
}

/**
 * Parse (in)valid JSON
 * 
 * @access private
 * @method parseJSON
 * 
 * @param {String} str - The input string
 * 
 * @return {Object|Object[]|String[]} The parsed object
 */
var parseJSON = function ( str ) {
  var object
  try {
    object = JSON.parse( str )
  } catch (e) {
    console.info( '[set]', 'Input was not valid JSON, switching to experimental parser for invalid JSON')
    try {
      object = JSON.parse(
        str
          .replace( varRegex.json[ 0 ][ 0 ], varRegex.json[ 0 ][ 1 ] )
          .replace( varRegex.json[ 1 ][ 0 ], varRegex.json[ 1 ][ 1 ] )
      )
    } catch (e) {
      console.error( '[set]', 'Experimental parser failed. Please improve the JSON. If this is not JSON, please re-read the supported formats.')
    }
  }
  return object
}

/**
 * Get CSL type from Wikidata type (P31)
 * 
 * @access private
 * @method fetchWikidataType
 * 
 * @param {String} value - Input P31 Wikidata ID
 * 
 * @return {String} Output CSL type
 */
var fetchWikidataType = function ( value ) {
  return varWikidataTypes[ value ]
}

/**
 * Get the names of objects from Wikidata IDs
 * 
 * @access private
 * @method fetchWikidataLabel
 * 
 * @param {String} q - Wikidata IDs, seperated by "|"
 * @param {String} lang - Language
 * 
 * @return {String[]} Array with labels of each prop
 */
var fetchWikidataLabel = function ( q, lang ) {
  var url = wdk.hasOwnProperty( 'getEntities' ) ? wdk.getEntities( q, [ lang ], 'labels' ) : (
  'https://www.wikidata.org/w/api.php' +
    '?origin=*&amp;action=wbgetentities&amp;languages=en&amp;format=json&amp;props=labels&amp;' + 
    'ids=' + q )
  
  var data     = fetchFile( url )
    , entities = JSON.parse( data ).entities
  
    , entKeys  = Object.keys( entities )
    , labels   = []
  
  for ( var entIndex = 0; entIndex &lt; entKeys.length; entIndex++ ) {
    var entKey = entKeys [ entIndex ]
      , entity = entities[ entKey   ]
    
    labels.push( entity.labels[ lang ].value )
  }
  
  return labels
}

/**
 * Transform property and value from Wikidata format to CSL
 * 
 * @access private
 * @method parseWikidataProp
 * 
 * @param {String} prop - Property
 * @param {String|Number} value - Value
 * @param {String} lang - Language
 * 
 * @return {String[]} Array with new prop and value
 */
var parseWikidataProp = function ( prop, value, lang ) { var value = value
  
  if ( !( [ ''
  , 'P50'
  , 'P2093'
  ].indexOf( prop ) > -1 ) ) value = value[ 0 ]
  
  var rProp = ''
    , rValue = value
  
  switch ( prop ) {
    
    // Author ( q )
    case 'P50':
      rProp = 'authorQ'
      rValue = value.map( function ( name ) { return parseName( fetchWikidataLabel( name, lang ) ) } )
      break;
    
    // Author ( s )
    case 'P2093':
      rProp = 'authorS'
      rValue = value.map( parseName )
      break;
    
    // Date
    case 'P580' :
    case 'P585' :
      rProp = 'accessed'
      rValue = parseDate( value )
      break;
    
    // DOI
    case 'P356' :
      rProp = 'DOI'
      break;
    
    // Instance of
    case 'P31'  :
      rProp = 'type'
      rValue = fetchWikidataType( value )
      
      if ( rValue === undefined )
        console.warn( '[set]', 'This entry type is not recognized and therefore interpreted as \'article-journal\':', value ),
        rValue = 'article-journal'
      break;
    
    // ISBN 13 &amp; 10
    case 'P212' :
    case 'P957' :
      rProp = 'ISBN'
      break;
    
    // Issue
    case 'P433' :
      rProp = 'issue'
      break;
    
    // Journal
    case 'P1433':
      rProp = 'container-title'
      rValue = fetchWikidataLabel( value, lang )[ 0 ]
      break;
    
    // Pages
    case 'P304' :
      rProp = 'page'
      break;
    
    // Print/edition
    case 'P393' :
      rProp = 'edition'
      break;
    
    // Pubdate
    case 'P577' :
      rProp = 'issued'
      rValue = parseDate( value )
      break;
    
    // Title
    case 'P1476':
      rProp = 'title'
      break;
    
    // Volume
    case 'P478' :
      rProp = 'volume'
      break;
    
    case 'P2860': // Cites
    case 'P921' : // Main subject
    case 'P3181': // OpenCitations bibliographic resource ID
    case 'P364' : // Original language of work
    case 'P698' : // PMID
    case 'P932' : // PMCID
      // Property ignored
      break;
    
    default:
      console.debug( '[set]', 'Unknown property:', prop )
      break;
  }
  
  return [ rProp, rValue ]
}

/**
 * Get Wikidata JSON from Wikidata IDs
 * 
 * @access private
 * @method parseWikidata
 * 
 * @param {String} data - Wikidata IDs
 * 
 * @return {Object} Wikidata JSON
 */
var parseWikidata = function ( data ) {
  var data = data.split( /(?:\s+|,)/g )
    , result
  
  if ( wdk.hasOwnProperty( 'getEntities' ) ) {
    var url = wdk.getEntities( {
      ids: data,
      languages: [ 'en' ]
    } )
    
    if ( Array.isArray( url ) ) {
      var urls = url
        , outs = []
      
      for ( var urlIndex = 0; urlIndex &lt; urls.length; urlIndex++ ) {
        var url = urls[ urlIndex ]
          , out = JSON.parse( fetchFile( url ) )
            outs= outs.concat( out )
      }
      
      result = outs
    } else result = JSON.parse( fetchFile( url ) )
  } else {
    var url =
    'https://www.wikidata.org/w/api.php?' +
      'origin=*&amp;' +
      'action=wbgetentities&amp;' + 
      'ids=' + data.join( '|' ) + '&amp;' +
      'languages=en&amp;' +
      'format=json'
    
    result = JSON.parse( fetchFile( url ) )
  }
  
  return result
}

/**
 * Format Wikidata data
 * 
 * @access private
 * @method parseWikidataJSON
 * 
 * @param {Object} data - The input data
 * 
 * @return {CSL[]} The formatted input data
 */
var parseWikidataJSON = function ( data ) {
  var output = []
    , entities = data.entities
    , entKeys  = Object.keys( entities )
  
  for ( var entIndex = 0; entIndex &lt; entKeys.length; entIndex++ ) {
    var entKey = entKeys[ entIndex ]
      , labels = entities[ entKey ].labels
      , entity = wdk.simplifyClaims( entities[ entKey ].claims )
    
    var json  = { wikiID: entKey, id: entKey }
      , props = Object.keys( entity )
    
    for ( var propIndex = 0; propIndex &lt; props.length; propIndex++ ) {
      var prop  = props[ propIndex ]
        , value = entity[ prop ]
        
      var resp = parseWikidataProp( prop, value, 'en' )
      
      if ( resp[ 0 ].length > 0 )
        json[ resp[ 0 ] ] = resp[ 1 ]
    }
    
    // It still has to combine authors from string value and numeric-id value :(
    if ( json.hasOwnProperty( 'authorQ' ) || json.hasOwnProperty( 'authorS' ) ) {
      
      if ( json.hasOwnProperty( 'authorQ' ) &amp;&amp; json.hasOwnProperty( 'authorS' ) ) {     
        if ( json.authorQ.length >= json.authorS.length )
          json.author = json.authorQ
        else if ( json.authorQ.length &lt; json.authorS.length )
          json.author = json.authorS
        
        delete        json.authorQ
        delete        json.authorS
      } else if ( json.hasOwnProperty( 'authorQ' ) ) {
        json.author = json.authorQ
        delete        json.authorQ
      } else if ( json.hasOwnProperty( 'authorS' ) ) {
        json.author = json.authorS
        delete        json.authorS
      }
    
    }
    
    if ( !( json.hasOwnProperty( 'title' ) &amp;&amp; json.title ) )
      json.title = labels[ 'en' ].value;
    
    output.push( json )
  }
  
  return output
}

/**
 * Transform property and value from BibTeX-JSON format to CSL-JSON
 * 
 * @access private
 * @method parseBibTeXProp
 * 
 * @param {String} prop - Property
 * @param {String|Number} value - Value
 * 
 * @return {String[]} Array with new prop and value
 */
var parseBibTeXProp = function ( prop, value ) {
  
  var rProp  = prop
    , rValue = value
  
  switch ( prop ) {
    
    // Author
    case 'author':
      rValue = value.split( ' and ' ).map( parseName )
      break;
    
    // DOI
    case 'doi':
      rProp = 'DOI'
      break;
    
    // Edition/print
    case 'edition':
      //rValue = parseOrdinal( value )
      break;
    
    // Editor
    case 'editor':
      rValue = value.split( ' and ' ).map( parseName )
      break;
    
    // ISBN
    case 'isbn':
      rProp = 'ISBN'
      break;
    
    // ISSN
    case 'issn':
      rProp = 'ISBN'
      break;
    
    // Issue
    case 'issue':
    case 'number':
      rProp = 'issue'
      rValue = value.toString()
      break;
    
    // Journal
    case 'journal':
      rProp = 'container-title'
      break;
    
    // Location
    case 'location':
      rProp = 'publisher-place'
      break;
    
    // Pages
    case 'pages':
      rProp = 'page'
      rValue = value.replace( /[]/, '-' )
      break;
    
    // Pubate
    case 'date':
      rProp = 'issued'
      rValue = parseDate( value )
      break;
    
    case 'year' :
      // Ignore for now
      //rProp = 'issued-year'
      break;
    
    case 'month' :
      // Ignore for now
      //rProp = 'issued-month'
      break;
    
    // Publisher
    case 'publisher':
      // Nothing necessary, as far as I know
      break;
    
    // Title
    case 'title':
      rProp = 'title'
      rValue = value.replace(/\.$/g,'')
      break;
    
    // Volume
    case 'volume':
      rValue = value.toString()
      break;
    
    case 'crossref': // Crossref
    case 'keywords': // Keywords
    case 'language': // Language
    case 'note': // Note
    case 'pmid': // PMID
    case 'url': // URL
      // Property ignored
      rProp = rValue = undefined
      break;
    
    default:
      console.debug( '[set]', 'Unknown property:', prop )
      rProp = rValue = undefined
      break;
  }
  
  if ( rProp !== undefined &amp;&amp; rValue !== undefined )
    return [ rProp, rValue ]
  else
    return undefined
}

/**
 * Format BibTeX JSON data
 * 
 * @access private
 * @method parseBibTeXJSON
 * 
 * @param {Object[]} data - The input data
 * 
 * @return {CSL[]} The formatted input data
 */
var parseBibTeXJSON = function ( data ) {
  var output = []
  
  for ( var entryIndex = 0; entryIndex &lt; data.length; entryIndex++ ) {
    var entry = data[ entryIndex ]
    
    for ( var prop in entry.properties ) {
      var val = parseBibTeXProp( prop, entry.properties[ prop ] )
      
      if ( val !== undefined )
        entry[ val[ 0 ] ] = val[ 1 ]
    }
    
    entry.type = parseBibTeXType( entry.type )
    entry.id   = entry.label
    
    delete entry.label
    delete entry.properties
    
    output[ entryIndex ] = entry
  }
  
  return output
}

/**
 * Format BibTeX data
 * 
 * @access private
 * @method parseBibTeX
 * 
 * @param {String} str - The input data
 * 
 * @return {CSL[]} The formatted input data
 */
var parseBibTeX = function ( str ) {
  
  var entries
  
  try {
    entries = []
    
    var stack = str
        // Clean weird commands
        .replace( /{?(\\[`"'^~=]){?\\?([A-Za-z])}/g, '{$1$2}')
        .replace( /{?(\\[a-z]){?\\?([A-Za-z])}/g, '{$1 $2}' )
        // Tokenize, with escaped characters in mind
        .split( new RegExp( '(?!^)(' +
          // Escaped chars
          '\\\\([#$%&amp;~_^\\\\{}])|' +
          // Regular commands
          '\\{\\\\(?:' +
          // Accented chars
            // Vowel regular
            '[`\'^~"=][AEIOUYaeiouy]|' +
            // Consonant regular
            '(?:[cv] |[\'])[CcDdGgKkLlNnRrSs]|' +
            // A-E
            '(?:[dkruv] )[Aa]|(?:[db] |\\.)[Bb]|[.^][Cc]|(?:[bd] |\\.)[Dd]|(?:[dkuv] |[.])[Ee]|' +
            // F-J
            '\\.[Ff]|(?:u |[=.^\'])[Gg]|(?:[cd] |[.^"])[Hh]|b h|[dv] [Ii]|=\\\\i|\\.I|(?:v |\\^)[Jj]|' +
            // K-O
            '(?:[bd] |\')[Kk]|[bd] [Ll]|[Ll] |(?:d |[.\'])[Mm]|(?:[bd] |[~.])[Nn]|[dHkuv] [Oo]|'+
            // P-U
            '[.\'][Pp]|(?:[bd] |[.])[Rr]|(?:d |[.^])[Ss]|(?:[bcdv] |[.])[Tt]|" t|[dHkruv] [Uu]|' +
            // V-Z
            '(?:d |[~])[Vv]|(?:d |[`".\'^])[Ww]|r w|[."][Xx]|(?:d |[.])[Yy]|r y|(?:[bdv] |[\'.^])[Zz]|' +
          // No break space
            '~|' +
          // Commands
            '\\w+' +
          ')\\}|' +
          // Greek letters and other symbols
          '\$\\\\(?:[A-Z]?[a-z]+|\\#|%&lt;)\\\\$|' +
          // Subscript and superscript
          '\\$[^_]\\{[0-9+-=()n]\\}\\$|' +
          // --, ---, '', ''', ``, ```
          '---|--|\'\'\'|\'\'|```|``|' +
          // ?!, !!, !?
          '\\?!|' + '!!|' + '!\\?\'|' +
          // \url and \href
          '\\\\(?:url|href)|' +
          '[\\s\\S]' +
        ')', 'g' ) )
        .filter( function ( v ) { return !!v } )
      
      , whitespace= varRegex.bibtex[ 1 ]
      , syntax= varRegex.bibtex[ 2 ]
      
      , dels  = {
        '"': '"'
      , '{': '}'
      , '"{': '}"'
      , '{{': '}}'
      , '': ''
      }
      
      , index = 0
      , curs  = stack[ index ]
      , obj
    
    while ( curs ) {
      
      while ( whitespace.test( curs ) )
        curs = stack[ ++index ]
      
      if ( !curs )
        break
      
      entries.push( { type: '', label: '', properties: {}} )
      obj = entries[ entries.length - 1 ]
      
      if ( curs === '@' )
        curs = stack[ ++index ]
      else
        throw new SyntaxError( `Unexpected token at index ${index}. Expected "@", got "${curs}".`  )
      
      while ( whitespace.test( curs ) )
        curs = stack[ ++index ]
      
      while ( ( !whitespace.test( curs ) &amp;&amp; !syntax.test( curs ) ) || curs.length > 1 )
        obj.type += curs
      , curs = stack[ ++index ]
      
      obj.type = obj.type.toLowerCase()
      
      while ( whitespace.test( curs ) )
        curs = stack[ ++index ]
      
      if ( curs === '{' )
        curs = stack[ ++index ]
      else
        throw new SyntaxError( `Unexpected token at index ${index}. Expected "{", got "${curs}".`  )
      
      while ( whitespace.test( curs ) )
        curs = stack[ ++index ]
      
      while ( ( !whitespace.test( curs ) &amp;&amp; !syntax.test( curs ) ) || curs.length > 1 ) {
        obj.label += curs
        curs = stack[ ++index ]
      }
      
      while ( whitespace.test( curs ) )
        curs = stack[ ++index ]
      
      if ( curs === ',' )
        curs = stack[ ++index ]
      else
        throw new SyntaxError( `Unexpected token at index ${index}. Expected ",", got "${curs}".`  )
      
      while ( whitespace.test( curs ) )
        curs = stack[ ++index ]
      
      var
          key
        , val
        
        , start_del
        , end_del
        
        , nexs
      
      while ( curs !== '}' ) {
        
        key       = '',
        val       = '',
        start_del = ''
        
        while ( curs &amp;&amp; !whitespace.test( curs ) &amp;&amp; curs !== '=' )
          key += curs,
          curs = stack[ ++index ]
        
        while ( whitespace.test( curs ) )
          curs = stack[ ++index ]
        
        if ( curs === '=' )
          curs = stack[ ++index ]
        else
          throw new SyntaxError( `Unexpected token at index ${index}. Expected "=", got "${curs}".`  )
        
        while ( whitespace.test( curs ) )
          curs = stack[ ++index ]
        
        while ( syntax.test( curs ) )
          start_del += curs,
          curs = stack[ ++index ]
        
        if ( !dels.hasOwnProperty( start_del ) )
          throw new SyntaxError(
            `Unexpected field delimiter at index ${index}. Expected ` +
            `${ Object.keys(dels).map( function ( v ) { return `"${v}"` } ).join( ', ' ) }, got "${start_del}".`
          )
        
        end_del = dels[ start_del ],
        nexs    = stack
          .slice( index + 1, index + ( end_del.length ? end_del.length : 1 ) )
          .reverse()
          .join( '' )
        
        while ( curs &amp;&amp; ( end_del === '' ?
          ( curs !== ',' )
        :
          ( curs + nexs !== end_del )
        ) ) {
          
          if ( varBibTeXTokens.hasOwnProperty( curs ) )
            val += varBibTeXTokens[ curs ]
          else if ( curs.match( /^\\([#$%&amp;~_^\\{}])$/ ) )
            val += curs.slice( 1 )
          else if ( curs.length > 1 )
            // "Soft", non-breaking error for now
            //throw new SyntaxError( 'Escape sequence not recognized: ' + curs )
            console.error( 'Escape sequence not recognized: ' + curs )
          else
            val += curs
          
          curs = stack[ ++index ]
          nexs = stack
            .slice( index + 1, index + ( end_del.length ? end_del.length : 1 ) )
            .reverse()
            .join( '' )
        }
        
        key = key
          .trim()
          .replace( /\s+/g, ' ' )
          .toLowerCase()
        
        val = val
          .replace( /[{}]/g, '' )
          .trim()
          .replace( /\s+/g, ' ' )
        
        obj.properties[ key ] = val
        
        end_del = end_del.split( '' )
        
        while ( end_del.pop() )
          curs = stack[ ++index ]
        
        while ( whitespace.test( curs ) )
          curs = stack[ ++index ]
        
        if ( curs === '}' )
          break
        else if ( curs === ',' )
          curs = stack[ ++index ]
        else
          throw new SyntaxError( `Unexpected token at index ${index}. Expected ",", "}", got "${curs}".`  )
        
        while ( whitespace.test( curs ) )
          curs = stack[ ++index ]
      }
      
      if ( curs === '}' )
        curs = stack[ ++index ]
      else
        throw new SyntaxError( `Unexpected token at index ${index}. Expected "}", got "${curs}".`  )
    
    }
  
    return entries
    
  } catch ( e ) {
    console.error( `Uncaught SyntaxError: ${e.message} Returning completed entries.` )
    
    // Remove last, incomplete entry
    entries.pop()
    
    return entries
  }
}

/**
 * Format ContentMine data
 * 
 * @access private
 * @method parseContentMine
 * 
 * @param {Object} data - The input data
 * 
 * @return {CSL[]} The formatted input data
 */
var parseContentMine = function ( data ) {
  var res = {}
    
    , dataKeys = Object.keys( data )
  
  for ( var dataKeyIndex = 0; dataKeyIndex &lt; dataKeys.length; dataKeyIndex++ ) {
    var prop = dataKeys[ dataKeyIndex ]
    res[ prop ] = data[ prop ].value[ 0 ]
  }
  
  res.type  = 'article-journal';
  
  if ( res.hasOwnProperty( 'authors'   ) ) res.author = data.authors.value.map( parseName )
  if ( res.hasOwnProperty( 'firstpage' ) ) res['page-first'] = res.firstpage,
                                           res.page   = res.firstpage
  if ( res.hasOwnProperty( 'date'      ) ) res.issued = parseDate( res.date )
  if ( res.hasOwnProperty( 'journal'   ) ) res['container-title'] = res.journal
  if ( res.hasOwnProperty( 'doi'       ) ) res.id     = res.doi, res.DOI = res.doi
  
  return res
}

/**
 * Determine input type (internal use)
 * 
 * @access private
 * @method parseInputType
 * 
 * @param {String|String[]|Object|Object[]} input - The input data
 * 
 * @return {String} The input type
 */
var parseInputType = function ( input ) {
  
  switch ( typeof input) {
    
    case 'string':
      
      // Empty
            if ( input.length === 0 )
        return 'string/empty'
      
      // Wikidata URL
      else if ( varRegex.wikidata[ 0 ].test( input ) )
        return 'url/wikidata'
      
      // Wikidata entity list
      else if ( varRegex.wikidata[ 2 ].test( input ) )
        return 'list/wikidata'
      
      // BibTeX
      else if ( varRegex.bibtex  [ 0 ].test( input ) )
        return 'string/bibtex'
      
      // JSON
      else if ( /^\s*(\{|\[)/.test( input ) )
        return 'string/json'
      
      // Else URL
      else if ( varRegex.url.test( input ) )
        return 'url/else'
      
      // Else
      else
        return console.warn( '[set]', 'This format is not supported or recognised' ) || 'invalid'
      
    case 'object':
      
      // Empty
            if ( input === null )
        return 'empty'
      
      // Array
      else if ( Array.isArray( input ) )
        return 'list/else'
      
      // jQuery
      else if ( window.jQuery &amp;&amp; input instanceof jQuery )
        return 'jquery/else'
      
      // HTML
      else if ( window.HMTLElement &amp;&amp; input instanceof HMTLElement)
        return 'html/else'
      
      // Wikidata
      else if ( input.hasOwnProperty( 'entities' ) )
        return 'json/wikidata'
      
      // ContentMine
      else if ( input.hasOwnProperty( 'fulltext_html' ) ||
                input.hasOwnProperty( 'fulltext_xml'  ) ||
                input.hasOwnProperty( 'fulltext_pdf'  ) )
        return 'json/contentmine'
      
      // Default
      else
        return 'json/csl'
      
      break;
    
    case 'undefined':
      
      // Empty
      return 'empty'
      
      break;
      
    default:
      
      return console.warn( '[set]', 'This format is not supported or recognised' ) || 'invalid'
      
      break;
  }
}

/**
 * Standardise input (internal use)
 * 
 * @access private
 * @method parseInputData
 * 
 * @param {String|String[]|Object|Object[]} input - The input data
 * @param {String} type - The input type
 * 
 * @return {CSL[]} The parsed input
 */
var parseInputData = function ( input, type ) {
  var output
  
  switch ( type ) {
    
    case 'url/wikidata':
      output = parseInput( parseWikidata( input.match( varRegex.wikidata[ 1 ] )[ 1 ] ) )
      break;
    
    case 'list/wikidata':
      output = parseInput( parseWikidata( input ) )
      break;
    
    case 'url/else':
      output = parseInput( fetchFile( input ) )
      break;
    
    case 'jquery/else':
      output = parseInput( data.val() || data.text() || data.html() )
      break;
    
    case 'html/else':
      output = parseInput( data.value || data.textContent )
      break;
    
    case 'string/json':
      output = parseInput( parseJSON( input ) )
      break;
    
    case 'string/bibtex':
      output = parseBibTeXJSON( parseBibTeX( input ) )
      break;
    
    case 'json/wikidata':
      output = parseWikidataJSON( input )
      break;
    
    case 'json/contentmine':
      output = parseContentMine( input )
      break;
    
    case 'list/else':
      output = []
      input.forEach( function ( value ) {
        output = output.concat( parseInput( value ) )
      } )
      break;
    
    case 'json/csl':
      output = [ input ]
      break;
    
    case 'string/empty':
    case 'empty'  :
    case 'invalid':
    default       :
      output = []
      break;
    
  }
  
  return output
}

/**
 * Parse input (internal use). Wrapper for `parseInputType()` and `parseInputData()`
 * 
 * @access private
 * @method parseInput
 * 
 * @param {String|String[]|Object|Object[]} input - The input data
 * 
 * @return {CSL[]} The parsed input
 */
var parseInput = function ( input ) {
  var type = parseInputType( input )
    , outp = parseInputData( input, type )
  
  return outp
}

/**
 * Convert a JSON array or object to HTML.
 * 
 * @access private
 * @function getJSONObjectHTML
 * 
 * @param {Object|Object[]|String[]|Number[]} src - The data
 * 
 * @return {String} The html (in string form)
 */

var getJSONObjectHTML = function ( src ) {
  var res = ''
  
  if ( Array.isArray( src ) ) {
    
    res += '[&lt;ul style="list-style-type:none">';
    
    for ( var entryIndex = 0; entryIndex &lt; src.length; entryIndex++ ) {
      var entry = src[ entryIndex ]
      
      res += '&lt;li>'
      res += getJSONValueHTML( entry )
      res += ',&lt;/li>'
      
    } 
    
    res += '&lt;/ul>]'
    
  } else if ( src !== null ) {
    
    res += '{&lt;ul style="list-style-type:none">';
    
    for ( var prop in src ) {
      
      var entry = src[ prop ]
      
      res += '&lt;li>&lt;span class="key">' + prop + '&lt;/span>&lt;span class="delimiter">:&lt;/span>'
      res += getJSONValueHTML( entry )
      res += ',&lt;/li>'
      
    }
    
    res += '&lt;/ul>}'
  }
  
  return res
}

/**
 * Convert JSON to HTML.
 * 
 * @access private
 * @function getJSONValueHTML
 * 
 * @param {Object|String|Number|Object[]|String[]|Number[]} src - The data
 * 
 * @return {String} The html (in string form)
 */
var getJSONValueHTML = function ( src ) {
  var res = ''
  
  if ( typeof src === 'object' &amp;&amp; src !== null ) {
    
    if ( src.length === 0 )
      res += '[]'
    else if ( Object.keys( src ).length === 0 )
      res += '{}'
    else
      res += getJSONObjectHTML( src )
    
  } else res += '&lt;span class="string">' + JSON.stringify( src ) + '&lt;/span>'
  
  return res
}

/**
 * Get a JSON HTML string from CSL
 * 
 * @access private
 * @method getJSON
 * 
 * @param {CSL[]} src - Input CSL
 * 
 * @return {String} JSON HTML string
 */
var getJSON = function ( src ) {
  var res = ''
    , dict= varHTMLDict
  
  res += dict.wr_start
  res += '['
  
  for ( var i = 0; i &lt; src.length; i++ ) {
    var entry = src[ i ]
    
    res += dict.en_start
    res += '{'
    
    res += dict.ul_start
    res += dict.li_start
    
    var props = Object.keys( entry )
    
    for ( var propIndex = 0; propIndex &lt; props.length; propIndex++ ) {
      var prop = props[ propIndex ]
        , value= entry[ prop ]
      
      res += prop + ':' + getJSONValueHTML( value )
      
      if ( propIndex + 1 &lt; props.length )
        res += ',',
        res += dict.li_end,
        res += dict.li_start
    }
    
    res += dict.li_end
    res += dict.ul_end
    
    res += '}'
    
    if ( i + 1 &lt; src.length )
      res += ','
    
    res += dict.en_end
  }
  
  res += dict.wr_end
  res += ']'
  
  return res
}

/**
 * @author Lars Willighagen
 * @version 0.2
 * @license
 * Copyright (c) 2015-2016 Lars Willighagen  
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:  
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.  
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 * @constructor Cite
 * 
 * @description Create a `Cite` object with almost any kind of data, and manipulate it with its default methods.
 * 
 * @param {String|CSL|Object|String[]|CSL[]|Object[]} data - Input data. If no data is passed, an empty object is returned
 * @param {Object} options - The options for the output
 * @param {String} [options.format="real"] - The outputted datatype. Real representation (`"real"`, e.g. DOM Object for HTML, JavaScript Object for JSON) or String representation ( `"string"` )
 * @param {String} [options.type="json"] - The format of the output. `"string"`, `"html"` or `"json"`
 * @param {String} [options.style="csl"] - The style of the output. See [Output](./#output)
 * @param {String} [options.lang="en-US"] - The language of the output. [RFC 5646](https://tools.ietf.org/html/rfc5646) codes
 */

 function Cite (data,options) {

  // Making it Scope-Safe
  if ( !( this instanceof Cite ) )
    return new Cite( data, options )
  
  /**
   * The default options for the output
   * 
   * @property format {String} The outputted datatype. Real representation (`"real"`, e.g. DOM Object for HTML, JavaScript Object for JSON) or String representation ( `"string"` )
   * @property type {String} The format of the output. `"string"`, `"html"` or `"json"`
   * @property style {String} The style of the output. See [Output](../#output)
   * @property lang {String} The language of the output. [RFC 5646](https://tools.ietf.org/html/rfc5646) codes
   * 
   * @type Object
   * @default {}
   */
  this._options = options || {}
  
  /**
   * Information about the input data
   *
   * @property data The inputted data
   * @property type {String} The datatype of the input
   * @property format {String} The format of the input
   * 
   * @type Object
   */
  this._input = {
    data: data
  , type: typeof data
  , format: parseInputType( data )
  }
  
  /**
   * The data formatted to JSON
   *
   * @type Object
   * @default []
   */
  this.data = []
  
  /**
   * The log, containing all logged data.
   * 
   * These are the names of each called function, together with it's input. If the `Cite` object is changed, the version number gets updated as well.
   * 
   * The `.reset()` function **does not** have any influence on the log. This way, you can still undo all changes.
   * 
   * &lt;br />&lt;br />
   * `.currentVersion()` and similar function **are not** logged, because this would be influenced by function using other functions.
   *
   * @type Object[]
   * 
   * @property {Object} 0 - The first version, indicated with version 0, containing the object as it was when it was made. The following properties are used for the following properties too.
   * @property {String} 0.name - The name of the called function. In case of the initial version, this is `"init"`.
   * @property {String} 0.version - The version of the object. Undefined when a function that doesn't change the object is called.
   * @property {Array} 0.arguments - The arguments passed in the called function.
   */
  this._log = [
    {name:'init',version:'0',arguments:[this._input.data,this._options]}
  ]
  
  // Public methods
  
  /**
   * 
   * @method currentVersion
   * @memberof Cite
   * @this Cite
   * 
   * @return {Number} The latest version of the object
   */
  this.currentVersion = function () {
    var version = 0
    
    for ( var i = 0; i &lt; this._log.length; i++ ) {
      if ( this._log[ i ].version > version )
        version = this._log[ i ].version
    }
    
    return version
  }
  
  /**
   * Does not change the current object.
   * 
   * @method retrieveVersion
   * @memberof Cite
   * @this Cite
   * 
   * @param {Number} versnum - The number of the version you want to retrieve. Illegel numbers: numbers under zero, floats, numbers above the current version of the object.
   * 
   * @return {Cite} The version of the object with the version number passed. `undefined` if an illegal number is passed.
   */
  this.retrieveVersion = function ( versnum ) {
    this._log.push( { name: 'retrieveVersion', arguments: [ versnum ] } )
    
    if ( versnum >= 0 &amp;&amp; versnum &lt;= this.currentVersion() ) {
      var obj = new Cite( this._log[ 0 ].arguments[ 0 ], this._log[ 0 ].arguments[ 1 ] ),
          arr = []
      
      for ( var i = 0; i &lt; this._log.length; i++ ) {
        if ( this._log[ i ].version )
          arr.push( this._log[ i ] )
      }
      
      for ( var k = 1; k &lt;= versnum; k++ ) {
        obj[ arr[ k ].name ].apply( obj, arr[ k ].arguments || [] )
      }
      
      return obj
    } else return undefined;
  }
  
  /**
   * Does not change the current object. Undoes the last edit made.
   * 
   * @method undo
   * @memberof Cite
   * @this Cite
   * 
   * @return {Cite} The last version of the object. `undefined` if used on first version.
   */
  this.undo = function () {
    return this.retrieveVersion( this.currentVersion() - 1 )
  }
  
  /**
   * Get a sorted ID list
   * 
   * @method getIds
   * @memberof Cite
   * @this Cite
   * 
   * @param {Boolean} nolog - Hide this call from the log (i.e. when used internally)
   * 
   * @return {String[]} List of IDs
   */
  this.getIds = function ( nolog ) {
    if( !nolog )
      this._log.push( { name: 'getIds' } )
    
    var list = []
    
    for ( var entryIndex = 0; entryIndex &lt; this.data.length; entryIndex++ )
      list.push( this.data[ entryIndex ].id )
    
    return list
  }
  
  /**
   * Add an object to the array of objects
   * 
   * @method add
   * @memberof Cite
   * @this Cite
   * 
   * @param {String|CSL|Object|String[]|CSL[]|Object[]} data - The data to add to your object
   * @param {Boolean} nolog - Hide this call from the log (i.e. when used internally)
   * 
   * @return {Cite} The updated parent object
   */
  this.add = function ( data, nolog ) {
    if ( !nolog )
      this._log.push( { name: 'add', version: this.currentVersion() + 1, arguments: [ data, nolog ] } )
    
    var input = parseInput( data )
    this.data = this.data.concat( input )
    
    var itemIds = this.getIds( true )
    for ( var entryIndex = 0; entryIndex &lt; this.data.length; entryIndex++ ) {
      if ( !this.data[ entryIndex ].hasOwnProperty( 'id' ) )
        this.data[ entryIndex ].id = fetchId( itemIds, entryIndex, 'temp_id_' )
    }
    
    return this
  }
  
  /**
   * Recreate a `Cite` object with almost any kind of data, and manipulate it with its default methods.
   * 
   * @method set
   * @memberof Cite
   * @this Cite
   * 
   * @param {String|CSL|Object|String[]|CSL[]|Object[]} data - The data to replace the data in your object
   * @param {Boolean} nolog - Hide this call from the log (i.e. when used internally)
   * 
   * @return {Cite} The updated parent object
   */
  this.set = function ( data, nolog ) {
    if ( !nolog )
      this._log.push( { name: 'set', version: this.currentVersion() + 1, arguments: [ data, nolog ] } )
    
    this.data = []
    this.add( data, true )
    
    return this
  }
  
  /**
   * Change the default options of a `Cite` object.
   * 
   * @method options
   * @memberof Cite
   * @this Cite
   * 
   * @param {Object} options - The options for the output
   * @param {String} [options.format="real"] - The outputted datatype. Real representation (`"real"`, e.g. DOM Object for HTML, JavaScript Object for JSON) or String representation ( `"string"` )
   * @param {String} [options.type="json"] - The format of the output. `"string"`, `"html"` or `"json"`
   * @param {String} [options.style="csl"] - The style of the output. See [Output](./#output)
   * @param {String} [options.lang="en-US"] - The language of the output. [RFC 5646](https://tools.ietf.org/html/rfc5646) codes
   * @param {Boolean} nolog - Hide this call from the log (i.e. when used internally)
   * 
   * @return {Cite} The updated parent object
   */
  this.options = function ( options, nolog ) {
    if ( !nolog )
      this._log.push( { name: 'options', version: this.currentVersion() + 1, arguments: [ options ] } )
    
    Object.assign( this._options, options )
    
    return this
  }
  
  /**
   * Reset a `Cite` object.
   * 
   * @method reset
   * @memberof Cite
   * @this Cite
   * 
   * @return {Cite} The updated, empty parent object (except the log, the log lives)
   */
  this.reset = function () {
    this._log.push( { name: 'reset', version: this.currentVersion() + 1, arguments: [] } )
    
    this.data     = []
    this._options = {}
    
    return this
  }
  
  /**
   * Sort the datasets alphabetically, on basis of it's BibTeX label
   * 
   * @method sort
   * @memberof Cite
   * @this Cite
   * 
   * @param {Boolean} nolog - Hide this call from the log (i.e. when used internally)
   * 
   * @return {Cite} The updated parent object
   */
  this.sort = function ( nolog ) {
    if( !nolog )
      this._log.push( { name: 'sort', version: this.currentVersion() + 1, arguments: [] } )
    
    this.data = this.data.sort( function ( a, b ) {
      var labela = getLabel( a )
        , labelb = getLabel( b )
      
      return labela != labelb ?
        ( labela > labelb ? 1 : -1 )
      : 0 ;
    } )
    
    return this
  }
  
  /**
   * Get formatted data from your object. For more info, see [Output](../#output).
   * 
   * @method get
   * @memberof Cite
   * @this Cite
   * 
   * @param {Object} options - The options for the output
   * @param {String} [options.format="real"] - The outputted datatype. Real representation (`"real"`, e.g. DOM Object for HTML, JavaScript Object for JSON) or String representation ( `"string"` )
   * @param {String} [options.type="json"] - The format of the output. `"string"`, `"html"` or `"json"`
   * @param {String} [options.style="csl"] - The style of the output. See [Output](../#output)
   * @param {String} [options.lang="en-US"] - The language of the output. [RFC 5646](https://tools.ietf.org/html/rfc5646) codes
   * @param {String} [options.locale] - Custom CSL locale for citeproc
   * @param {String} [options.template] - Custom CSL style template for citeproc
   * @param {Boolean} nolog - Hide this call from the log (i.e. when used internally)
   * 
   * @return {String|Object[]} The formatted data
   */
  this.get = function ( options, nolog ) {
    if( !nolog )
      this._log.push( { name: 'get', arguments: [ options ] } )
    
    var _data   = JSON.parse( JSON.stringify( this.data ) )
      , result
      
      , options = Object.assign(
          { format:'real',type:'json',style:'csl',lang:'en-US' },
          this._options,
          { locale: '', template: '' },
          options )
      
      , type    = options.type.toLowerCase()
      , styleParts = options.style.toLowerCase().split( '-' )
      , style   = styleParts[ 0 ]
      , styleFormat = styleParts.slice( 1 ).join( '-' )
    
    switch ( type ) {
      case 'html':
        
        switch ( style ) {
          
          case 'citation':
            var cb_locale = !options.locale ? fetchCSLLocale : function () { return options.locale }
              , cb_item   = fetchCSLItemCallback( _data )
              , template  = options.template ? options.template : fetchCSLStyle( styleFormat )
              , lang      = fetchCSLLocale( options.lang ) ? options.lang : 'en-US'
              , citeproc  = fetchCSLEngine( styleFormat, lang, template, cb_item, cb_locale )
              
              , sortIds   = citeproc.updateItems( this.getIds( true ) )
              , bib       = citeproc.makeBibliography()
              
              , start     = bib[ 0 ].bibstart
              , body      = bib[ 1 ]
              , end       = bib[ 0 ].bibend
            
            for ( var i = 0; i &lt; body.length; i++ ) {
              body[ i ] = getPrefixedEntry( body[ i ], i, sortIds )
            }
            
            result = start + body.join( '&lt;br />' ) + end
            break;
          
          case 'csl':
            result = getJSON( _data )
            break;
          
          case 'bibtex':
            result = getBibTeX( _data, true )
            break;
        }
        
        break;
      
      case 'string':
        
        switch ( style ) {
          
          case 'bibtex':
            result = getBibTeX( _data, false )
            break;
          
          case 'citation':
            var options = Object.assign( {}, options, {type:'html'} )
            result = striptags( this.get( options, true ) )
            break;
          
          case 'csl':
            result = JSON.stringify( _data )
            break;
        }
        
        break;
      
      case 'json':
        
        switch ( style ) {
          
          case 'csl':
            result = JSON.stringify( _data )
            break;
          
          case 'bibtex':
            result = JSON.stringify( _data.map( getBibTeXJSON ) )
            break;
          
          case 'citation':
            console.error( '[get]', 'Combination type/style of json/citation-* is not valid:', options.type + '/' + options.style )
            result = undefined
            break;
        }
        
        break;
    }
    
    if ( options.format === 'real' ) {
      if ( options.type === 'json' )
        result = JSON.parse( result )
      else if ( browserMode &amp;&amp; options.type === 'html' ) {
        var tmp = document.createElement( 'div' )
        tmp.innerHTML = result
        result = result.childNodes
      }
    }
    
    return result
  }
  
  this.set( data, true )
  this.options( options, true )
  
}

return Cite

})(
  ( typeof require  === 'function' ? {
    CSL: require( './citeproc.js' ).CSL
  , striptags: require( 'striptags' )
  , request: require( 'sync-request' )
  , window: {}
  , wdk: require( 'wikidata-sdk' )
  } : {
    CSL: CSL
  , striptags: function ( html ) {
      var tmp = document.createElement( 'div' )
      tmp.innerHTML = html
      return tmp.textContent || tmp.innerText || ''
    }
  , request: function ( method, url ) {
      var xhr  
      
      try {
        xhr = new XMLHttpRequest()
        if ( xhr.withCredentials !== undefined ) {
          xhr.open(method, url, false)
        } else {
          xhr = null
        }
      } catch ( e ) {
        xhr = null
      }
      
      if ( xhr ) {
        xhr.send( null )
        return { getBody: function () { return xhr.responseText } }
      } else
        console.error( 'CORS not supported' )
        return 'null'
    }
  , window: window
  , wdk: { simplifyClaims: function ( array ) {
      var obj = {}
      
      Object.keys( array ).forEach( function ( id ) {
        var claims = array[ id ].map( function ( claim ) {
          if ( claim.hasOwnProperty( 'mainsnak' ) ) {
            var mainsnak = claim.mainsnak
              , ref = [mainsnak.datatype, mainsnak.datavalue]
              , datatype = ref[0]
              , datavalue = ref[1]
              , value
            
            switch (datatype) {
              case 'string':
              case 'commonsMedia':
              case 'external-id':
                value = datavalue.value
                break;
              
              case 'wikibase-item':
                value = 'Q' + datavalue.value['numeric-id']
                break;
              
              case 'time':
                
                var month, rest, sign, year;
                var parts = datavalue.value.time.split( '-' );
                
                switch (parts.length) {
                  case 3:
                    year  = parts[0],
                    month = parts[1],
                    rest  = parts[2]
                    break;
                  
                  case 4:
                    sign  = parts[0],
                    year  = parts[1],
                    month = parts[2],
                    rest  = parts[3],
                    year  = '-' + year
                    break;
                  
                  default:
                    console.error( '[set]', 'Unknown Wikidata time format:', datavalue.value.time );
                    break;
                }
                
                var day = rest.slice(0, 2);
                
                value = new Date(year, month - 1, day).getTime()
                break;
              
              default:
                value = null
            }
            return value
          } else {
            return undefined
          }
        } )
        obj[ id ] = claims
      } )
      
      return obj
    } }
  } )
, ( typeof process  !== 'undefined' &amp;&amp; typeof global   !== 'undefined' )
, ( typeof location !== 'undefined' &amp;&amp; typeof document !== 'undefined' )
)

if ( typeof require  === 'function' )
  require( 'module' ),
  module.exports = Cite</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Cite.html">Cite</a></li><li><a href="CSL.html">CSL</a></li><li><a href="jQuery.html">jQuery</a></li><li><a href="jQueryCite.html">jQueryCite</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Dec 28 2016 16:37:54 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
